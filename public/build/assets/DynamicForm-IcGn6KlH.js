import{R as x,d as f,r as A,j as s,m as R}from"./app-BOZhZNcF.js";import{b as g,f as M,d as B,e as U,g as G,a as H,c as J}from"./index.esm-BN7amb27.js";function ee(O){const[K,Q]=x.useState(!0),[i,F]=x.useState(null),[d,y]=x.useState({}),[u,k]=x.useState({}),[W,X]=x.useState(!1),[S,b]=x.useState({}),[q,E]=x.useState(!1),[v,C]=x.useState({}),{formSlug:T}=O,[w,D]=x.useState(null),L=e=>{const n={};return e.forEach(t=>{var r,o;let a;switch(t.type){case"email":a=g().email("Please enter a valid email address");break;case"url":a=g().url("Please enter a valid URL");break;case"tel":a=g().matches(/^[\+]?[1-9][\d]{0,15}$/,"Please enter a valid phone number");break;case"number":a=H().typeError("Please enter a valid number"),t.min!==void 0&&(a=a.min(t.min,`Minimum value is ${t.min}`)),t.max!==void 0&&(a=a.max(t.max,`Maximum value is ${t.max}`));break;case"date":a=G().typeError("Please enter a valid date");break;case"checkbox":t.options&&Object.keys(t.options).length>1?(a=B(),t.required&&(a=a.min(1,`Please select at least one ${t.label.toLowerCase()}`))):(a=U(),t.required&&(a=a.oneOf([!0],`${t.label} is required`)));break;case"radio":a=g();break;case"select":a=g();break;case"file":if(a=M(),t.required&&(a=a.required(`${t.label} is required`)),(r=t.options)!=null&&r.max_size&&(a=a.test("fileSize",`File size must be less than ${t.options.max_size}MB`,m=>!m||m&&m.size<=t.options.max_size*1024*1024)),(o=t.options)!=null&&o.accept){const m=t.options.accept.split(",").map(p=>p.trim());a=a.test("fileType",`File type must be one of: ${m.join(", ")}`,p=>!p||m.some(c=>c==="*"||p.type.includes(c.replace("*",""))))}break;case"textarea":case"text":default:a=g();break}t.required&&t.type!=="checkbox"&&t.type!=="file"&&(a=a.required(`${t.label} is required`)),t.min_length&&(t.type==="text"||t.type==="textarea")&&(a=a.min(t.min_length,`${t.label} must be at least ${t.min_length} characters`)),t.max_length&&(t.type==="text"||t.type==="textarea")&&(a=a.max(t.max_length,`${t.label} must be no more than ${t.max_length} characters`)),n[t.name]=a}),J().shape(n)};x.useEffect(()=>{f.get(`/api/v1/form/${T}`).then(e=>{console.log(e.data),F(e.data.form);const n=L(e.data.fields);D(n);const t={},a={};e.data.fields.forEach(r=>{if(r.type==="checkbox"&&r.options?t[r.name]=[]:r.default_value?t[r.name]=r.default_value:t[r.name]="",(r.type==="radio"||r.type==="checkbox")&&r.options&&Object.keys(r.options).length>1){const o=Object.keys(r.options)[0];a[r.name]=o}}),y(t),C(a)}).catch(e=>{console.error("Error fetching form:",e)})},[]);const $=async(e,n)=>{if(w)try{await w.validateAt(e,{[e]:n}),b(t=>({...t,[e]:null}))}catch(t){b(a=>({...a,[e]:t.message}))}},h=(e,n)=>{y(t=>({...t,[e]:n})),S[e]&&b(t=>({...t,[e]:null})),$(e,n)},z=(e,n)=>{n&&(k(t=>({...t,[e]:n})),y(t=>({...t,[e]:n.name}))),$(e,value)},P=(e,n,t)=>{y(a=>{const r=a[e]||[];return t?{...a,[e]:[...r,n]}:{...a,[e]:r.filter(o=>o!==n)}}),$(e,n)},_=(e,n)=>{C(t=>({...t,[e]:n}))},V=async e=>{e.preventDefault(),E(!0),b({});try{if(w){const r={...d};Object.keys(u).forEach(o=>{u[o]&&(r[o]=u[o])}),await w.validate(r,{abortEarly:!1})}const n=new FormData;Object.keys(d).forEach(r=>{Array.isArray(d[r])?d[r].forEach(o=>{n.append(`${r}[]`,o)}):n.append(r,d[r]||"")}),Object.keys(u).forEach(r=>{u[r]&&n.append(r,u[r])});const t=R.post(route("client.submit.form",i.slug),n,{preserveScroll:!0,preserveState:!0,headers:{"Content-Type":"multipart/form-data"}});let a={};i.fields.forEach(r=>{var o;if(r.type==="radio"&&r.options){const m=v==null?void 0:v[r.name],p=((o=r.options)==null?void 0:o[m])||"";a[r.name]=p}else r.type==="checkbox"&&r.options?a[r.name]=[]:a[r.name]=""}),y(a),k({})}catch(n){if(console.error("Form submission error:",n),n.name==="ValidationError"){const t={};n.inner.forEach(a=>{t[a.path]=a.message}),b(t)}else n.response&&n.response.data&&n.response.data.errors?b(n.response.data.errors):alert("There was an error submitting the form. Please try again.")}finally{E(!1)}},I=e=>{var p;const n=d[e.name]||"",t=S[e.name],a=`field-${e.name}`,r=v[e.name],o="w-full bg-transparent ",m=t?"border-red-500":"";switch(e.type){case"text":case"email":case"url":case"tel":return s.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[s.jsx("input",{id:a,type:e.type,value:n,onChange:c=>h(e.name,c.target.value),placeholder:e.placeholder||e.label,required:e.required,maxLength:e.max_length,minLength:e.min_length,className:`${o} ${m}`}),t&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"number":return s.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[s.jsx("input",{id:a,type:"number",value:n,onChange:c=>h(e.name,c.target.value),placeholder:e.placeholder||e.label,required:e.required,className:`${o} ${m}`}),t&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"textarea":return s.jsxs("div",{className:"w-full",children:[s.jsx("textarea",{id:a,value:n,onChange:c=>h(e.name,c.target.value),placeholder:e.placeholder||e.label,required:e.required,maxLength:e.max_length,minLength:e.min_length,rows:4,className:`${o} ${m}`}),t&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"select":return s.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[s.jsxs("select",{id:a,value:n,onChange:c=>h(e.name,c.target.value),required:e.required,className:`${o} ${m}`,children:[s.jsx("option",{value:"",children:e.placeholder||`Select ${e.label}`}),e.options&&Object.entries(e.options).map(([c,l])=>s.jsx("option",{value:c,children:l},c))]}),t&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"radio":if(e.options&&Object.keys(e.options).length>1){const c=Object.entries(e.options);return s.jsxs("div",{className:"w-full",children:[s.jsx("div",{className:"flex mb-6 mt-6 text-sm",children:c.map(([l,j],N)=>s.jsxs("div",{className:"flex items-center",children:[s.jsxs("button",{type:"button",onClick:()=>{_(e.name,l),h(e.name,j)},className:"flex flex-col items-start pr-6 text-left contact-us-hover",children:[s.jsxs("span",{className:"fc-primary",children:["0",N+1]}),s.jsxs("span",{className:`relative text-[22px] ${r===l?"capitalize fc-secondary":"text-white"}`,children:[j,r===l&&s.jsx("span",{className:"absolute left-0 -bottom-1 w-1/2 border-b-2 border-lime-400"})]})]}),N<c.length-1&&s.jsx("div",{className:"border-r border-gray-600 h-6 mx-3"})]},l))}),s.jsx("div",{className:"mt-4 hidden",children:s.jsxs("label",{className:"flex items-center text-white",children:[s.jsx("input",{type:"hidden",name:e.name,value:r,required:e.required,className:"mr-2"}),"Select ",e.options[r]]})}),t&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id)}else return s.jsxs("div",{className:"w-full",children:[s.jsx("label",{className:"block text-white mb-2",children:e.label}),s.jsx("div",{className:"space-y-2",children:e.options&&Object.entries(e.options).map(([c,l])=>s.jsxs("label",{className:"flex items-center text-white",children:[s.jsx("input",{type:"radio",name:e.name,value:c,checked:n===c,onChange:j=>h(e.name,j.target.value),required:e.required,className:"mr-2"}),l]},c))}),t&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"checkbox":if(e.options&&Object.keys(e.options).length>1){const c=Object.entries(e.options);return s.jsxs("div",{className:"w-full",children:[s.jsx("label",{className:"block text-white mb-2",children:e.label}),s.jsx("div",{className:"flex mb-6 mt-6 text-sm",children:c.map(([l,j],N)=>s.jsxs("div",{className:"flex items-center",children:[s.jsxs("button",{type:"button",onClick:()=>_(e.name,l),className:"flex flex-col items-start pr-6 text-left",children:[s.jsxs("span",{className:"fc-primary",children:["0",N+1]}),s.jsxs("span",{className:`relative text-[18px] ${r===l?"fc-secondary":"text-white"}`,children:[j,r===l&&s.jsx("span",{className:"absolute left-0 -bottom-1 w-1/2 border-b-2 border-lime-400"})]})]}),N<c.length-1&&s.jsx("div",{className:"border-r border-gray-600 h-6 mx-3"})]},l))}),s.jsx("div",{className:"mt-4",children:s.jsxs("label",{className:"flex items-center text-white",children:[s.jsx("input",{type:"checkbox",checked:(n||[]).includes(r),onChange:l=>P(e.name,r,l.target.checked),className:"mr-2"}),"Select ",e.options[r]]})}),n&&n.length>0&&s.jsx("div",{className:"mt-2",children:s.jsxs("p",{className:"text-sm text-gray-400",children:["Selected: ",n.map(l=>e.options[l]).join(", ")]})}),t&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id)}else return s.jsxs("div",{className:"w-full",children:[s.jsxs("label",{className:"flex items-center text-white",children:[s.jsx("input",{type:"checkbox",checked:!!n,onChange:c=>h(e.name,c.target.checked),className:"mr-2"}),e.placeholder||e.label]}),t&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"file":return s.jsxs("div",{className:"w-full",children:[s.jsx("label",{className:"block text-white mb-2",children:e.label}),s.jsx("input",{id:a,type:"file",onChange:c=>z(e.name,c.target.files[0]),required:e.required,accept:((p=e.options)==null?void 0:p.accept)||"*",className:"w-full p-3 bg-transparent border border-gray-600 rounded-md text-white file:bg-purple-600 file:text-white file:border-none file:rounded file:px-4 file:py-2 file:mr-4"}),u[e.name]&&s.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Selected: ",u[e.name].name]}),t&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"date":return s.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[s.jsx("input",{id:a,type:"date",value:n,onChange:c=>h(e.name,c.target.value),required:e.required,className:`${o} ${m}`}),t&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"hidden":return s.jsx("input",{type:"hidden",name:e.name,value:n||e.default_value||""},e.id);default:return s.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[s.jsx("input",{id:a,type:"text",value:n,onChange:c=>h(e.name,c.target.value),placeholder:e.placeholder||e.label,required:e.required,className:`${o} ${m}`}),t&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id)}};return A.useEffect(()=>{i&&i.fields&&i.fields.forEach(e=>{(e.type==="radio"||e.type==="checkbox")&&e.options&&h(e.name,e.options[0])})},[i]),s.jsx(s.Fragment,{children:s.jsxs("div",{className:"",children:[i&&i.fields&&s.jsx("form",{onSubmit:V,className:"",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-6 py-6 transform transition-transform duration-500 ease-in-out",children:[s.jsx("div",{className:"flex flex-col md:flex-row md:flex-wrap gap-4 text-white justify-between",children:i.fields.map(e=>I(e))}),s.jsxs("button",{type:"submit",disabled:q,className:"group flex items-center justify-content-end gap-2 bg-transparent border-none fc-primary transition-colors duration-300 text-lg font-medium cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:[q?"Submitting...":i.submit_button_text||"Submit",s.jsx("span",{className:"fc-purple group-hover:translate-x-1 transition-transform",children:"â†’"})]})]})}),!i&&s.jsx("div",{className:"flex items-center justify-center text-white",children:s.jsx("p",{children:"Loading form..."})})]})})}export{ee as default};
