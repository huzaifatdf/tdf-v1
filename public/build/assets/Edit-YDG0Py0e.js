import{r as s,j as e,R as z,q as B,m as D,$ as J}from"./app-BvJgUZ4-.js";import{A as W}from"./AuthenticatedLayout-_fp3J4jE.js";import{B as f,i as S,X as O,t as K}from"./toast-DVF7Lw72.js";import{T as q}from"./textarea-rli-eMuk.js";import{S as Q,a as X,b as G,c as Y,d as A}from"./select-X49CxJqa.js";import{c as Z,g as V,b as L,F as ee,d as te,e as I,E as C}from"./index.esm-BV8ORnk7.js";import U from"./Model-DReOMoZh.js";import{C as se}from"./chevron-down-DOYQYuhu.js";import"./createLucideIcon-DytnjVVw.js";import"./index-D86pplSv.js";import"./index-DcpyZ_VW.js";import"./alert-B-nNuzOB.js";import"./Modal-DWeMiAA8.js";import"./transition-B8XcNSt3.js";import"./search-S2rUJmU6.js";import"./trash-2-tmA5q9tL.js";import"./video-BZUINAQY.js";import"./upload-Cxkp0Hsr.js";import"./download-DKiXjKPg.js";import"./eye-DicjpGyf.js";const P=new Set,T=(t,o="script")=>new Promise((b,d)=>{if(P.has(t)){b();return}const a=o==="script"?document.createElement("script"):document.createElement("link");o==="script"?(a.src=t,a.onload=()=>{P.add(t),b()},a.onerror=d):(a.rel="stylesheet",a.href=t,a.onload=()=>{P.add(t),b()},a.onerror=d),document.head.appendChild(a)}),F=z.memo(({value:t,onChange:o,placeholder:b,height:d=200})=>{const a=s.useRef(null),[p,w]=s.useState(t||""),h=s.useCallback(n=>{const y=n.target.innerHTML;w(y),o(y)},[o]),g=s.useCallback(n=>{if(n.ctrlKey||n.metaKey)switch(n.key){case"b":n.preventDefault(),document.execCommand("bold");break;case"i":n.preventDefault(),document.execCommand("italic");break;case"u":n.preventDefault(),document.execCommand("underline");break}},[]),i=s.useCallback((n,y=null)=>{var v;document.execCommand(n,!1,y),(v=a.current)==null||v.focus()},[]);return s.useEffect(()=>{a.current&&p!==a.current.innerHTML&&(a.current.innerHTML=p)},[p]),e.jsxs("div",{className:"border rounded-md overflow-hidden",children:[e.jsxs("div",{className:"border-b p-2 bg-gray-50 flex gap-1 flex-wrap",children:[e.jsx(f,{type:"button",variant:"ghost",size:"sm",onClick:()=>i("bold"),className:"px-2 py-1 text-xs h-8",title:"Bold (Ctrl+B)",children:e.jsx("strong",{children:"B"})}),e.jsx(f,{type:"button",variant:"ghost",size:"sm",onClick:()=>i("italic"),className:"px-2 py-1 text-xs h-8",title:"Italic (Ctrl+I)",children:e.jsx("em",{children:"I"})}),e.jsx(f,{type:"button",variant:"ghost",size:"sm",onClick:()=>i("underline"),className:"px-2 py-1 text-xs h-8",title:"Underline (Ctrl+U)",children:e.jsx("u",{children:"U"})}),e.jsx("div",{className:"w-px bg-gray-300 mx-1"}),e.jsx(f,{type:"button",variant:"ghost",size:"sm",onClick:()=>i("insertUnorderedList"),className:"px-2 py-1 text-xs h-8",title:"Bullet List",children:"â€¢"}),e.jsx(f,{type:"button",variant:"ghost",size:"sm",onClick:()=>i("insertOrderedList"),className:"px-2 py-1 text-xs h-8",title:"Numbered List",children:"1."}),e.jsx("div",{className:"w-px bg-gray-300 mx-1"}),e.jsx(f,{type:"button",variant:"ghost",size:"sm",onClick:()=>i("createLink",prompt("Enter URL:")),className:"px-2 py-1 text-xs h-8",title:"Insert Link",children:"ðŸ”—"}),e.jsx(f,{type:"button",variant:"ghost",size:"sm",onClick:()=>i("removeFormat"),className:"px-2 py-1 text-xs h-8",title:"Clear Formatting",children:"âœ•"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{ref:a,contentEditable:!0,onInput:h,onKeyDown:g,className:"p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset",style:{minHeight:`${d}px`,wordBreak:"break-word",lineHeight:"1.5"},dangerouslySetInnerHTML:{__html:p},suppressContentEditableWarning:!0}),!p&&e.jsx("div",{className:"absolute top-3 left-3 pointer-events-none text-gray-400 select-none",style:{lineHeight:"1.5"},children:b||"Enter content..."})]})]})});F.displayName="SimpleRichTextEditor";const _=z.memo(({value:t,onChange:o,placeholder:b,height:d=200})=>{const a=s.useRef(null),[p,w]=s.useState(!1),h=s.useRef(null),g=s.useRef(!0);return s.useEffect(()=>{if(!p||!a.current||!window.$||!window.$.fn.summernote)return;const i=window.$(a.current);if(h.current){t!==i.summernote("code")&&i.summernote("code",t||"");return}return i.summernote({placeholder:b||"Enter content...",tabsize:2,height:d,toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],callbacks:{onChange:n=>{g.current&&o(n)}}}),h.current=i,t&&i.summernote("code",t),()=>{if(h.current&&h.current.summernote){try{h.current.summernote("destroy")}catch(n){console.error("Error destroying Summernote:",n)}h.current=null}}},[p,d,b]),s.useEffect(()=>{h.current&&t!==h.current.summernote("code")&&h.current.summernote("code",t||"")},[t]),s.useEffect(()=>{const i=()=>window.$&&window.$.fn.summernote?(w(!0),!0):!1;if(!i()){const n=setInterval(()=>{i()&&clearInterval(n)},100);return()=>{clearInterval(n),g.current=!1}}},[]),p?e.jsx("div",{className:"summernote-wrapper",children:e.jsx("textarea",{ref:a,className:"form-control",style:{display:"none"},defaultValue:t||""})}):e.jsxs("div",{className:"border rounded-md p-4 bg-gray-50 flex items-center justify-center",style:{height:`${d+40}px`},children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Loading advanced editor..."})]})});_.displayName="AdvancedSummernoteEditor";const re=({value:t="",onChange:o,placeholder:b="Enter content...",height:d=200,className:a="",disabled:p=!1,showToggle:w=!0,defaultMode:h="simple"})=>{const[g,i]=s.useState(h),[n,y]=s.useState(!1),[v,k]=s.useState(!1);s.useEffect(()=>{window.$&&window.$.fn.summernote&&k(!0)},[]);const E=s.useCallback(async()=>{if(!(n||v)){y(!0);try{window.jQuery||await T("https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"),await Promise.all([T("https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-lite.min.css","link"),T("https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-lite.min.js")]),k(!0),i("advanced")}catch($){console.error("Failed to load Summernote:",$)}finally{y(!1)}}},[n,v]),M=s.useCallback(()=>{g==="simple"?v?i("advanced"):E():i("simple")},[g,v,E]);return p?e.jsx("div",{className:`border rounded-md p-3 bg-gray-50 ${a}`,style:{minHeight:`${d}px`},dangerouslySetInnerHTML:{__html:t||`<span class="text-gray-400">${b}</span>`}}):e.jsxs("div",{className:`summernote-input-wrapper ${a}`,children:[w&&e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["Editor: ",g==="simple"?"Simple":"Advanced"]}),e.jsx(f,{type:"button",variant:"ghost",size:"sm",onClick:M,disabled:n,className:"text-xs h-6 px-2",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-current mr-1"}),"Loading..."]}):`Switch to ${g==="simple"?"Advanced":"Simple"}`})]}),g==="simple"?e.jsx(F,{value:t,onChange:o,placeholder:b,height:d}):e.jsx(_,{value:t,onChange:o,placeholder:b,height:d})]})};function Se(){const{product:t,additionalDataStructure:o,appUrl:b}=B().props,[d,a]=s.useState(b+"/"+t.image||null),[p,w]=s.useState(b+"/"+t.thumbnail||null),[h,g]=s.useState({Detail:!1,"Our Work":!1,Problem:!1,"problem Solutions":!1,seo:!1}),i=Z({title:L().required("Title is required").min(2,"Title must be at least 2 characters").max(255,"Title must not exceed 255 characters"),slug:L().required("Slug is required").matches(/^[a-z0-9-]+$/,"Slug can only contain lowercase letters, numbers, and hyphens"),description:L().required("Description is required").min(10,"Description must be at least 10 characters"),status:L().required("Status is required").oneOf(["published","draft"],"Invalid status"),priority:V().required("Priority is required").min(0,"Priority must be at least 0").max(100,"Priority must not exceed 100")}),n=s.useCallback((c,{setSubmitting:m})=>{const l=new FormData;["title","slug","description","status","priority"].forEach(r=>{l.append(r,c[r])}),l.append("image",c.image),l.append("thumbnail",c.thumbnail);const u={};Object.keys(o).forEach(r=>{u[r]={},Object.keys(o[r]).forEach(N=>{const j=`${r}_${N}`;c[j]!==void 0&&c[j]!==""&&(u[r][N]=c[j])}),Object.keys(u[r]).length===0&&delete u[r]}),Object.keys(u).length>0&&l.append("additional_data",JSON.stringify(u)),l.append("_method","PUT"),D.post(route("product.update",t.id),l,{forceFormData:!0,onSuccess:()=>m(!1),onError:()=>m(!1)})},[t.id,o]),y=s.useCallback((c,m,l)=>{c(m,null),l(null)},[]),v=s.useCallback(c=>{g(m=>({...m,[c]:!m[c]}))},[]),k=s.useCallback((c,m,l,x,u)=>{const r=`${c}_${m}`,N=x[r]||"";switch(l.type){case"summernote":return e.jsx(re,{value:N,onChange:j=>u(r,j),placeholder:`Enter ${l.label.toLowerCase()}`,height:200,showToggle:!0,defaultMode:"simple"});case"textarea":return e.jsx(q,{id:r,name:r,value:N,onChange:j=>u(r,j.target.value),placeholder:`Enter ${l.label.toLowerCase()}`,rows:3});case"number":return e.jsx(S,{id:r,name:r,type:"number",value:N,onChange:j=>u(r,j.target.value),placeholder:`Enter ${l.label.toLowerCase()}`,step:"0.01"});default:return e.jsx(S,{id:r,name:r,type:"text",value:N,onChange:j=>u(r,j.target.value),placeholder:`Enter ${l.label.toLowerCase()}`})}},[]),E=s.useCallback(()=>{const c={title:t.title||"",slug:t.slug||"",description:t.description||"",image:t.image||null,thumbnail:t.thumbnail||null,status:t.status||"",priority:t.priority||0},m=t.data?JSON.parse(t.data):{};return Object.keys(o).forEach(l=>{Object.keys(o[l]).forEach(x=>{var r;const u=`${l}_${x}`;c[u]=((r=m[l])==null?void 0:r[x])||""})}),c},[t,o]),[M,$]=s.useState(!1),[H,R]=s.useState(!1);return e.jsxs(W,{children:[e.jsx(J,{title:`Edit Product - ${t.title}`}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx("div",{className:"@container/main flex flex-1 flex-col gap-2 p-10",children:e.jsx("div",{className:"w-full",children:e.jsx(ee,{initialValues:E(),validationSchema:i,onSubmit:n,children:({isSubmitting:c,setFieldValue:m,values:l})=>e.jsxs(te,{className:"space-y-6 bg-white p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Edit Product"}),e.jsx("p",{className:"text-gray-600",children:"Update product information"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"title",className:"text-sm font-medium",children:"Product Title *"}),e.jsx(I,{as:S,id:"title",name:"title",placeholder:"Enter product title"}),e.jsx(C,{name:"title",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"slug",className:"text-sm font-medium",children:"Product Slug *"}),e.jsx(I,{as:S,id:"slug",name:"slug",placeholder:"Enter product slug"}),e.jsx(C,{name:"slug",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"description",className:"text-sm font-medium",children:"Description *"}),e.jsx(I,{as:q,id:"description",name:"description",placeholder:"Enter product description",rows:4}),e.jsx(C,{name:"description",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"status",className:"text-sm font-medium",children:"Status *"}),e.jsxs(Q,{name:"status",value:l.status,onValueChange:x=>m("status",x),children:[e.jsx(X,{children:e.jsx(G,{placeholder:"Select status"})}),e.jsxs(Y,{children:[e.jsx(A,{value:"published",children:"Published"}),e.jsx(A,{value:"draft",children:"Draft"})]})]}),e.jsx(C,{name:"status",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"priority",className:"text-sm font-medium",children:"Priority (0-100) *"}),e.jsx(I,{as:S,id:"priority",name:"priority",type:"number",min:"0",max:"100",placeholder:"0"}),e.jsx(C,{name:"priority",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"image",className:"text-sm font-medium",children:"Product Image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:[e.jsx(f,{type:"button",variant:"outline",onClick:()=>$(!0),className:"w-full",children:d?"Change Media":"Add Media"}),e.jsx(U,{routename:route("product.edit",t.id),showModal:M,setShowModal:$,setFieldValue:m,fieldName:"image",setImagePreview:a}),d&&e.jsxs("div",{className:"relative mt-4 inline-block",children:[e.jsx("img",{src:typeof d=="string"?d:URL.createObjectURL(d),alt:"Product Preview",className:"w-24 h-24 object-cover rounded-lg"}),e.jsx(f,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 p-0",onClick:()=>y(m,"image",a),children:e.jsx(O,{className:"h-3 w-3"})})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"thumbnail",className:"text-sm font-medium",children:"Thumbnail Image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:[e.jsx(f,{type:"button",variant:"outline",onClick:()=>R(!0),className:"w-full",children:p?"Change Media":"Add Media"}),e.jsx(U,{routename:route("product.edit",t.id),showModal:H,setShowModal:R,setFieldValue:m,fieldName:"thumbnail",setImagePreview:w}),p&&e.jsxs("div",{className:"relative mt-4 inline-block",children:[e.jsx("img",{src:typeof p=="string"?p:URL.createObjectURL(p),alt:"Thumbnail Preview",className:"w-24 h-24 object-cover rounded-lg"}),e.jsx(f,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 p-0",onClick:()=>y(m,"thumbnail",w),children:e.jsx(O,{className:"h-3 w-3"})})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:"Additional Information"}),Object.keys(o).map(x=>e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("button",{type:"button",className:"w-full px-4 py-3 text-left flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors",onClick:()=>v(x),children:[e.jsx("span",{className:"font-medium capitalize",children:x.replace("_"," ")}),h[x]?e.jsx(se,{className:"h-4 w-4 transition-transform"}):e.jsx(K,{className:"h-4 w-4 transition-transform"})]}),h[x]&&e.jsx("div",{className:"p-4 space-y-4 border-t bg-white",children:Object.keys(o[x]).map(u=>{const r=o[x][u],N=`${x}_${u}`;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:N,className:"text-sm font-medium text-gray-700",children:[r.label,r.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),k(x,u,r,l,m)]},u)})})]},x))]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(f,{type:"button",variant:"outline",onClick:()=>D.get(route("product.index")),children:"Cancel"}),e.jsx(f,{type:"submit",disabled:c,children:c?"Updating...":"Update Product"})]})]})})})})})]})}export{Se as default};
