import{q as W,r as g,j as e,$ as U,m as b}from"./app-DVHyN0e0.js";import{A as G}from"./AuthenticatedLayout-D-dL8kmN.js";import{B as o,i as d}from"./toast-C4Tc2BcL.js";import{T as x}from"./textarea-Cm_1aMur.js";import{S as v,a as f,b as _,c as F,d as y}from"./select-BtupKiWx.js";import{C,a as S,e as $,c as q}from"./card-B3YddZCH.js";import{D as H,a as M,b as Y,c as J,d as K}from"./dialog-CBnHyGtJ.js";import{L as i}from"./label-D0U68_IJ.js";import{S as Q}from"./switch-BtzAbKl4.js";import{T as X,a as Z,b as w,c as T,G as V}from"./tabs-B7wvHTEl.js";import{c as E,a as ee,b as m,F as se,d as le,e as h,E as N,f as ae}from"./index.esm-DhjSRILc.js";import{P as te}from"./plus-BsRl8Nqk.js";import{S as re}from"./settings-bXeSbfRp.js";import{T as ie}from"./trash-2-DVODPE74.js";import{E as ne}from"./eye-B1R-G9ku.js";import"./createLucideIcon-BBNjQThe.js";import"./index-CwBMlUCV.js";import"./index-CorY2y56.js";import"./chevron-down-DambfSdn.js";const ce=[{value:"text",label:"Text"},{value:"email",label:"Email"},{value:"number",label:"Number"},{value:"tel",label:"Telephone"},{value:"url",label:"URL"},{value:"textarea",label:"Textarea"},{value:"select",label:"Select Dropdown"},{value:"radio",label:"Radio Button"},{value:"checkbox",label:"Checkbox"},{value:"date",label:"Date"},{value:"file",label:"File Upload"},{value:"hidden",label:"Hidden Field"}],de=[{value:"full",label:"Full Width"},{value:"half",label:"Half Width"},{value:"third",label:"Third Width"}];function we(){const{form:r}=W().props,[k,D]=g.useState("form-settings"),[O,p]=g.useState(null),[L,j]=g.useState(!1),I=E({name:m().required("Form name is required").min(2,"Name must be at least 2 characters"),slug:m().required("Slug is required").matches(/^[a-z0-9-]+$/,"Slug can only contain lowercase letters, numbers, and hyphens"),submit_button_text:m().required("Submit button text is required"),success_message:m().required("Success message is required"),fields:ee().of(E({name:m().required("Field name is required"),label:m().required("Field label is required"),type:m().required("Field type is required")})).min(1,"At least one field is required")}),z=()=>({name:r.name||"",description:r.description||"",slug:r.slug||"",submit_button_text:r.submit_button_text||"Submit",success_message:r.success_message||"Thank you for your submission!",redirect_url:r.redirect_url||"",notification_email:r.notification_email||"",email_subject:r.email_subject||"",status:r.status||"active",require_captcha:r.require_captcha||!1,store_submissions:r.store_submissions!==!1,fields:r.fields?r.fields.map(l=>({id:l.id,name:l.name,label:l.label,type:l.type,placeholder:l.placeholder||"",default_value:l.default_value||"",help_text:l.help_text||"",required:l.required||!1,max_length:l.max_length||null,min_length:l.min_length||null,options:l.options||[],sort_order:l.sort_order||0,width:l.width||"full"})):[]}),A=(l,{setSubmitting:a,resetForm:t})=>{!l.slug&&l.name&&(l.slug=l.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")),b.put(route("form.update",r.id),l,{onSuccess:()=>{a(!1)},onError:s=>{a(!1),console.error("Form submission errors:",s)}})},B=(l,a="text")=>{const t={name:`field_${Date.now()}`,label:"New Field",type:a,placeholder:"",default_value:"",help_text:"",required:!1,max_length:null,min_length:null,options:[],sort_order:l.form.values.fields.length,width:"full"};l.push(t),p(l.form.values.fields.length),j(!0)},P=(l,a)=>{l.remove(a)},R=({field:l,index:a,setFieldValue:t})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:`fields.${a}.name`,children:"Field Name"}),e.jsx(d,{id:`fields.${a}.name`,value:l.name,onChange:s=>t(`fields.${a}.name`,s.target.value),placeholder:"field_name"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:`fields.${a}.label`,children:"Field Label"}),e.jsx(d,{id:`fields.${a}.label`,value:l.label,onChange:s=>t(`fields.${a}.label`,s.target.value),placeholder:"Field Label"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:`fields.${a}.type`,children:"Field Type"}),e.jsxs(v,{value:l.type,onValueChange:s=>t(`fields.${a}.type`,s),children:[e.jsx(f,{children:e.jsx(_,{})}),e.jsx(F,{children:ce.map(s=>e.jsx(y,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:`fields.${a}.width`,children:"Width"}),e.jsxs(v,{value:l.width,onValueChange:s=>t(`fields.${a}.width`,s),children:[e.jsx(f,{children:e.jsx(_,{})}),e.jsx(F,{children:de.map(s=>e.jsx(y,{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:`fields.${a}.placeholder`,children:"Placeholder"}),e.jsx(d,{id:`fields.${a}.placeholder`,value:l.placeholder||"",onChange:s=>t(`fields.${a}.placeholder`,s.target.value),placeholder:"Enter placeholder text"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:`fields.${a}.help_text`,children:"Help Text"}),e.jsx(d,{id:`fields.${a}.help_text`,value:l.help_text||"",onChange:s=>t(`fields.${a}.help_text`,s.target.value),placeholder:"Optional help text"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{id:`fields.${a}.required`,checked:l.required||!1,onCheckedChange:s=>t(`fields.${a}.required`,s)}),e.jsx(i,{htmlFor:`fields.${a}.required`,children:"Required Field"})]}),["select","radio","checkbox"].includes(l.type)&&e.jsxs("div",{children:[e.jsx(i,{children:"Options (one per line)"}),e.jsx(x,{value:l.options?l.options.join(`
`):"",onChange:s=>{const n=s.target.value.split(`
`).filter(c=>c.trim());t(`fields.${a}.options`,n)},placeholder:`Option 1
Option 2
Option 3`,rows:4})]})]});return e.jsxs(G,{children:[e.jsx(U,{title:`Edit Form - ${r.name}`}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsxs("div",{className:"@container/main flex flex-1 flex-col gap-2 p-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h1",{className:"text-3xl font-bold",children:["Edit Form: ",r.name]}),e.jsx(o,{variant:"outline",onClick:()=>b.get(route("form.index")),children:"Back to Forms"})]}),e.jsx(se,{initialValues:z(),validationSchema:I,onSubmit:A,children:({isSubmitting:l,setFieldValue:a,values:t})=>e.jsxs(le,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(C,{children:[e.jsx(S,{children:e.jsx($,{children:"Form Builder"})}),e.jsx(q,{children:e.jsxs(X,{value:k,onValueChange:D,children:[e.jsxs(Z,{className:"mb-4",children:[e.jsx(w,{value:"form-settings",children:"Form Settings"}),e.jsx(w,{value:"form-fields",children:"Form Fields"})]}),e.jsx(T,{value:"form-settings",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"name",children:"Form Name"}),e.jsx(h,{as:d,id:"name",name:"name",placeholder:"Contact Form",onChange:s=>{a("name",s.target.value);const n=t.slug,c=r.name?r.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,""):"";if(!n||n===c){const u=s.target.value.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"");a("slug",u)}}}),e.jsx(N,{name:"name",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"slug",children:"Form Slug"}),e.jsx(h,{as:d,id:"slug",name:"slug",placeholder:"contact-form"}),e.jsx(N,{name:"slug",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"description",children:"Description"}),e.jsx(h,{as:x,id:"description",name:"description",placeholder:"Optional form description"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"submit_button_text",children:"Submit Button Text"}),e.jsx(h,{as:d,id:"submit_button_text",name:"submit_button_text",placeholder:"Submit"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"success_message",children:"Success Message"}),e.jsx(h,{as:x,id:"success_message",name:"success_message",placeholder:"Thank you for your submission!"})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"notification_email",children:"Notification Email"}),e.jsx(h,{as:d,id:"notification_email",name:"notification_email",type:"email",placeholder:"admin@example.com"})]})]})}),e.jsx(T,{value:"form-fields",children:e.jsx(ae,{name:"fields",children:s=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Form Fields"}),e.jsxs(o,{type:"button",onClick:()=>B(s),size:"sm",children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Add Field"]})]}),t.fields.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:'No fields added yet. Click "Add Field" to get started.'})}):e.jsx("div",{className:"space-y-2",children:t.fields.map((n,c)=>e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg bg-gray-50",children:[e.jsx(V,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:n.label}),e.jsxs("div",{className:"text-sm text-gray-500",children:[n.type," â€¢ ",n.required?"Required":"Optional",n.id&&e.jsxs("span",{className:"ml-2 text-xs bg-blue-100 text-blue-800 px-1 rounded",children:["ID: ",n.id]})]})]}),e.jsxs(H,{open:L&&O===c,onOpenChange:u=>{j(u),u||p(null)},children:[e.jsx(M,{asChild:!0,children:e.jsx(o,{type:"button",variant:"outline",size:"sm",onClick:()=>{p(c),j(!0)},children:e.jsx(re,{className:"w-4 h-4"})})}),e.jsxs(Y,{className:"max-w-2xl",children:[e.jsx(J,{children:e.jsx(K,{children:"Edit Field"})}),e.jsx(R,{field:n,index:c,setFieldValue:a})]})]}),e.jsx(o,{type:"button",variant:"outline",size:"sm",onClick:()=>P(s,c),children:e.jsx(ie,{className:"w-4 h-4"})})]},n.id||c))}),e.jsx(N,{name:"fields",component:"div",className:"text-red-500 text-sm"})]})})})]})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(C,{children:[e.jsx(S,{children:e.jsxs($,{className:"flex items-center",children:[e.jsx(ne,{className:"w-4 h-4 mr-2"}),"Preview"]})}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-gray-50",children:[e.jsx("h3",{className:"font-medium",children:t.name||"Form Name"}),t.description&&e.jsx("p",{className:"text-sm text-gray-600",children:t.description}),t.fields.map((s,n)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs(i,{className:"text-sm",children:[s.label,s.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),s.type==="textarea"?e.jsx(x,{placeholder:s.placeholder,disabled:!0,className:"bg-white"}):s.type==="select"?e.jsx(v,{disabled:!0,children:e.jsx(f,{className:"bg-white",children:e.jsx(_,{placeholder:s.placeholder||"Select an option"})})}):e.jsx(d,{type:s.type,placeholder:s.placeholder,disabled:!0,className:"bg-white"}),s.help_text&&e.jsx("p",{className:"text-xs text-gray-500",children:s.help_text})]},s.id||n)),e.jsx(o,{disabled:!0,className:"w-full",children:t.submit_button_text})]})})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>b.get(route("form.index")),children:"Cancel"}),e.jsx(o,{type:"submit",disabled:l,children:l?"Updating...":"Update Form"})]})]})})]})})]})}export{we as default};
