import{r as s,j as e,R as B,q as J,m as q,$ as K}from"./app-C29a_2kn.js";import{A as W}from"./AuthenticatedLayout-j2_Ok3MP.js";import{B as w,i as $,X as F,t as Q}from"./toast-DgekXgFY.js";import{T as U}from"./textarea-C5_WpsFX.js";import{S as G,a as Y,b as Z,c as V,d as _}from"./select-D_LZW3qu.js";import{c as ee,g as te,b as I,F as se,d as re,e as A,E as T}from"./index.esm-OcgGLYVu.js";import z from"./Model-rpCGhdMi.js";import{C as ae}from"./chevron-down-DgQ5FdCb.js";import"./createLucideIcon-Cp999um6.js";import"./index-Dfd0sql8.js";import"./index-BmF1J8Ow.js";import"./alert-addcKh7T.js";import"./Modal-CuuLcdoh.js";import"./transition-BWltP9vh.js";import"./search-CJg3Hq0t.js";import"./trash-2-CoVl8dmR.js";import"./video-v6ool7mT.js";import"./upload-DjAugsew.js";import"./download-B5iNl4Gh.js";import"./eye-BnBN8maJ.js";const O=new Set,P=(t,m="script")=>new Promise((v,g)=>{if(O.has(t)){v();return}const o=m==="script"?document.createElement("script"):document.createElement("link");m==="script"?(o.src=t,o.onload=()=>{O.add(t),v()},o.onerror=g):(o.rel="stylesheet",o.href=t,o.onload=()=>{O.add(t),v()},o.onerror=g),document.head.appendChild(o)}),H=B.memo(({value:t,onChange:m,placeholder:v,height:g=200})=>{const o=s.useRef(null),[b,L]=s.useState(t||""),[y,N]=s.useState(!1),u=s.useCallback(r=>{const c=r.target.innerHTML;L(c),m(c)},[m]),p=s.useCallback(r=>{var c,j;if(r.ctrlKey||r.metaKey)switch(r.key){case"b":r.preventDefault(),document.execCommand("bold");break;case"i":r.preventDefault(),document.execCommand("italic");break;case"u":r.preventDefault(),document.execCommand("underline");break}if(r.key==="Enter"){const f=window.getSelection();if(f.rangeCount>0){const n=f.getRangeAt(0).commonAncestorContainer;if(n.nodeType===Node.TEXT_NODE?(c=n.parentElement)==null?void 0:c.closest("li"):(j=n.closest)==null?void 0:j.call(n,"li"))return}}},[]),h=s.useCallback((r,c=null)=>{var n;const j=o.current;if(!j)return;j.focus();const f=window.getSelection();let R=null;if(f.rangeCount>0&&(R=f.getRangeAt(0)),r==="insertOrderedList"||r==="insertUnorderedList"){const l=((n=f.anchorNode)==null?void 0:n.nodeType)===Node.TEXT_NODE?f.anchorNode.parentElement:f.anchorNode,i=l==null?void 0:l.closest("ol, ul");if(l==null||l.closest("li"),i){const x=i.tagName.toLowerCase()==="ol",d=r==="insertOrderedList";if(x===d)document.execCommand(r,!1,null);else{const a=d?"ol":"ul",k=document.createElement(a);if(Array.from(i.children).forEach(D=>{k.appendChild(D.cloneNode(!0))}),i.parentNode.replaceChild(k,i),R)try{f.removeAllRanges(),f.addRange(R)}catch{const M=document.createRange();M.selectNodeContents(j),M.collapse(!1),f.removeAllRanges(),f.addRange(M)}const C=new Event("input",{bubbles:!0});j.dispatchEvent(C);return}}else document.execCommand(r,!1,null)}else document.execCommand(r,!1,c);setTimeout(()=>{j.focus();const l=new Event("input",{bubbles:!0});j.dispatchEvent(l)},10)},[]),E=s.useCallback(()=>{N(!0)},[]),S=s.useCallback(()=>{N(!1)},[]);return s.useEffect(()=>{if(o.current&&b!==o.current.innerHTML){const r=window.getSelection(),c=r.rangeCount>0?r.getRangeAt(0):null;if(o.current.innerHTML=b,c&&o.current.contains(c.commonAncestorContainer))try{r.removeAllRanges(),r.addRange(c)}catch{const f=document.createRange();f.selectNodeContents(o.current),f.collapse(!1),r.removeAllRanges(),r.addRange(f)}}},[b]),e.jsxs("div",{className:"border rounded-md overflow-hidden",children:[e.jsxs("div",{className:"border-b p-2 bg-gray-50 flex gap-1 flex-wrap",children:[e.jsx(w,{type:"button",variant:"ghost",size:"sm",onClick:()=>h("bold"),className:"px-2 py-1 text-xs h-8 hover:bg-gray-200",title:"Bold (Ctrl+B)",children:e.jsx("strong",{children:"B"})}),e.jsx(w,{type:"button",variant:"ghost",size:"sm",onClick:()=>h("italic"),className:"px-2 py-1 text-xs h-8 hover:bg-gray-200",title:"Italic (Ctrl+I)",children:e.jsx("em",{children:"I"})}),e.jsx(w,{type:"button",variant:"ghost",size:"sm",onClick:()=>h("underline"),className:"px-2 py-1 text-xs h-8 hover:bg-gray-200",title:"Underline (Ctrl+U)",children:e.jsx("u",{children:"U"})}),e.jsx("div",{className:"w-px bg-gray-300 mx-1"}),e.jsx(w,{type:"button",variant:"ghost",size:"sm",onClick:()=>h("insertUnorderedList"),className:"px-2 py-1 text-xs h-8 hover:bg-gray-200",title:"Bullet List",children:e.jsx("span",{className:"text-lg leading-none",children:"â€¢"})}),e.jsx(w,{type:"button",variant:"ghost",size:"sm",onClick:()=>h("insertOrderedList"),className:"px-2 py-1 text-xs h-8 hover:bg-gray-200",title:"Numbered List",children:e.jsx("span",{className:"text-sm font-mono",children:"1."})}),e.jsx("div",{className:"w-px bg-gray-300 mx-1"}),e.jsx(w,{type:"button",variant:"ghost",size:"sm",onClick:()=>{const r=prompt("Enter URL:");r&&h("createLink",r)},className:"px-2 py-1 text-xs h-8 hover:bg-gray-200",title:"Insert Link",children:"ðŸ”—"}),e.jsx(w,{type:"button",variant:"ghost",size:"sm",onClick:()=>h("removeFormat"),className:"px-2 py-1 text-xs h-8 hover:bg-gray-200",title:"Clear Formatting",children:"âœ•"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{ref:o,contentEditable:!0,onInput:u,onKeyDown:p,onFocus:E,onBlur:S,className:"p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset",style:{minHeight:`${g}px`,wordBreak:"break-word",lineHeight:"1.5"},dangerouslySetInnerHTML:{__html:b},suppressContentEditableWarning:!0}),!b&&!y&&e.jsx("div",{className:"absolute top-3 left-3 pointer-events-none text-gray-400 select-none",style:{lineHeight:"1.5"},children:v||"Enter content..."})]}),e.jsx("style",{jsx:!0,children:`
        .p-3 ol {
          list-style-type: decimal;
          margin-left: 1.5em;
          padding-left: 0.5em;
        }
        .p-3 ul {
          list-style-type: disc;
          margin-left: 1.5em;
          padding-left: 0.5em;
        }
        .p-3 li {
          margin: 0.25em 0;
          padding-left: 0.25em;
        }
        .p-3 ol ol {
          list-style-type: lower-alpha;
        }
        .p-3 ol ol ol {
          list-style-type: lower-roman;
        }
        .p-3 ul ul {
          list-style-type: circle;
        }
        .p-3 ul ul ul {
          list-style-type: square;
        }
      `})]})});H.displayName="SimpleRichTextEditor";const X=B.memo(({value:t,onChange:m,placeholder:v,height:g=200})=>{const o=s.useRef(null),[b,L]=s.useState(!1),y=s.useRef(null),N=s.useRef(!0);return s.useEffect(()=>{if(!b||!o.current||!window.$||!window.$.fn.summernote)return;const u=window.$(o.current);if(y.current){t!==u.summernote("code")&&u.summernote("code",t||"");return}return u.summernote({placeholder:v||"Enter content...",tabsize:2,height:g,toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],styleTags:["p",{title:"Blockquote",tag:"blockquote",className:"blockquote",value:"blockquote"},"pre","h1","h2","h3","h4","h5","h6"],callbacks:{onChange:p=>{N.current&&m(p)},onInit:function(){t&&N.current&&u.summernote("code",t);const p=u.next(".note-editor").find(".note-toolbar");p.find('[data-name="ul"]').off("click").on("click",function(h){h.preventDefault(),u.summernote("editor.insertUnorderedList")}),p.find('[data-name="ol"]').off("click").on("click",function(h){h.preventDefault(),u.summernote("editor.insertOrderedList")})},onKeydown:function(p){var h,E;if(p.keyCode===13){const S=window.getSelection();if(S.rangeCount>0){const c=S.getRangeAt(0).commonAncestorContainer,j=c.nodeType===Node.TEXT_NODE?(h=c.parentElement)==null?void 0:h.closest("li"):(E=c.closest)==null?void 0:E.call(c,"li");if(j&&j.textContent.trim()==="")return!0}}return!0}}}),y.current=u,()=>{if(y.current&&y.current.summernote){try{y.current.summernote("destroy")}catch(p){console.error("Error destroying Summernote:",p)}y.current=null}}},[b,g,v]),s.useEffect(()=>{y.current&&t!==y.current.summernote("code")&&y.current.summernote("code",t||"")},[t]),s.useEffect(()=>{const u=()=>window.$&&window.$.fn.summernote?(L(!0),!0):!1;if(!u()){const p=setInterval(()=>{u()&&clearInterval(p)},100);return()=>{clearInterval(p),N.current=!1}}},[]),b?e.jsxs("div",{className:"summernote-wrapper",children:[e.jsx("textarea",{ref:o,className:"form-control",style:{display:"none"},defaultValue:t||""}),e.jsx("style",{jsx:!0,global:!0,children:`
        .note-editable ol {
          list-style-type: decimal !important;
          margin-left: 1.5em !important;
          padding-left: 0.5em !important;
        }
        .note-editable ul {
          list-style-type: disc !important;
          margin-left: 1.5em !important;
          padding-left: 0.5em !important;
        }
        .note-editable li {
          margin: 0.25em 0 !important;
          padding-left: 0.25em !important;
          display: list-item !important;
        }
        .note-editable ol ol {
          list-style-type: lower-alpha !important;
        }
        .note-editable ol ol ol {
          list-style-type: lower-roman !important;
        }
        .note-editable ul ul {
          list-style-type: circle !important;
        }
        .note-editable ul ul ul {
          list-style-type: square !important;
        }
      `})]}):e.jsxs("div",{className:"border rounded-md p-4 bg-gray-50 flex items-center justify-center",style:{height:`${g+40}px`},children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Loading advanced editor..."})]})});X.displayName="AdvancedSummernoteEditor";const ne=({value:t="",onChange:m,placeholder:v="Enter content...",height:g=200,className:o="",disabled:b=!1,showToggle:L=!0,defaultMode:y="simple"})=>{const[N,u]=s.useState(y),[p,h]=s.useState(!1),E=s.useRef(!1);s.useEffect(()=>{window.$&&window.$.fn.summernote&&(E.current=!0)},[]);const S=s.useCallback(async()=>{if(!(p||E.current)){h(!0);try{window.jQuery||await P("https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"),await Promise.all([P("https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-lite.min.css","link"),P("https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-lite.min.js")]),E.current=!0,u("advanced")}catch(c){console.error("Failed to load Summernote:",c),u("simple")}finally{h(!1)}}},[p]),r=s.useCallback(()=>{N==="simple"?E.current?u("advanced"):S():u("simple")},[N,S]);return b?e.jsx("div",{className:`border rounded-md p-3 bg-gray-50 ${o}`,style:{minHeight:`${g}px`},dangerouslySetInnerHTML:{__html:t||`<span class="text-gray-400">${v}</span>`}}):e.jsxs("div",{className:`summernote-input-wrapper ${o}`,children:[L&&e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["Editor: ",N==="simple"?"Simple":"Advanced"]}),e.jsx(w,{type:"button",variant:"ghost",size:"sm",onClick:r,disabled:p,className:"text-xs h-6 px-2",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-current mr-1"}),"Loading..."]}):`Switch to ${N==="simple"?"Advanced":"Simple"}`})]}),N==="simple"?e.jsx(H,{value:t,onChange:m,placeholder:v,height:g}):e.jsx(X,{value:t,onChange:m,placeholder:v,height:g})]})};function Ee(){const{product:t,additionalDataStructure:m,appUrl:v}=J().props,[g,o]=s.useState(v+"/"+t.image||null),[b,L]=s.useState(v+"/"+t.thumbnail||null),[y,N]=s.useState({Detail:!1,"Our Work":!1,Problem:!1,"problem Solutions":!1,seo:!1}),u=ee({title:I().required("Title is required").min(2,"Title must be at least 2 characters").max(255,"Title must not exceed 255 characters"),slug:I().required("Slug is required").matches(/^[a-z0-9-]+$/,"Slug can only contain lowercase letters, numbers, and hyphens"),description:I().required("Description is required").min(10,"Description must be at least 10 characters"),status:I().required("Status is required").oneOf(["published","draft"],"Invalid status"),priority:te().required("Priority is required").min(0,"Priority must be at least 0").max(100,"Priority must not exceed 100")}),p=s.useCallback((n,{setSubmitting:l})=>{const i=new FormData;["title","slug","description","status","priority"].forEach(a=>{i.append(a,n[a])}),i.append("image",n.image),i.append("thumbnail",n.thumbnail);const d={};Object.keys(m).forEach(a=>{d[a]={},Object.keys(m[a]).forEach(k=>{const C=`${a}_${k}`;n[C]!==void 0&&n[C]!==""&&(d[a][k]=n[C])}),Object.keys(d[a]).length===0&&delete d[a]}),Object.keys(d).length>0&&i.append("additional_data",JSON.stringify(d)),i.append("_method","PUT"),q.post(route("product.update",t.id),i,{forceFormData:!0,onSuccess:()=>l(!1),onError:()=>l(!1)})},[t.id,m]),h=s.useCallback((n,l,i)=>{n(l,null),i(null)},[]),E=s.useCallback(n=>{N(l=>({...l,[n]:!l[n]}))},[]),S=s.useCallback((n,l,i,x,d)=>{const a=`${n}_${l}`,k=x[a]||"";switch(i.type){case"summernote":return e.jsx(ne,{value:k,onChange:C=>d(a,C),placeholder:`Enter ${i.label.toLowerCase()}`,height:200,showToggle:!0,defaultMode:"simple"});case"textarea":return e.jsx(U,{id:a,name:a,value:k,onChange:C=>d(a,C.target.value),placeholder:`Enter ${i.label.toLowerCase()}`,rows:3});case"number":return e.jsx($,{id:a,name:a,type:"number",value:k,onChange:C=>d(a,C.target.value),placeholder:`Enter ${i.label.toLowerCase()}`,step:"0.01"});default:return e.jsx($,{id:a,name:a,type:"text",value:k,onChange:C=>d(a,C.target.value),placeholder:`Enter ${i.label.toLowerCase()}`})}},[]),r=s.useCallback(()=>{const n={title:t.title||"",slug:t.slug||"",description:t.description||"",image:t.image||null,thumbnail:t.thumbnail||null,status:t.status||"",priority:t.priority||0},l=t.data?JSON.parse(t.data):{};return Object.keys(m).forEach(i=>{Object.keys(m[i]).forEach(x=>{var a;const d=`${i}_${x}`;n[d]=((a=l[i])==null?void 0:a[x])||""})}),n},[t,m]),[c,j]=s.useState(!1),[f,R]=s.useState(!1);return e.jsxs(W,{children:[e.jsx(K,{title:`Edit Product - ${t.title}`}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx("div",{className:"@container/main flex flex-1 flex-col gap-2 p-10",children:e.jsx("div",{className:"w-full",children:e.jsx(se,{initialValues:r(),validationSchema:u,onSubmit:p,children:({isSubmitting:n,setFieldValue:l,values:i})=>e.jsxs(re,{className:"space-y-6 bg-white p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Edit Product"}),e.jsx("p",{className:"text-gray-600",children:"Update product information"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"title",className:"text-sm font-medium",children:"Product Title *"}),e.jsx(A,{as:$,id:"title",name:"title",placeholder:"Enter product title"}),e.jsx(T,{name:"title",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"slug",className:"text-sm font-medium",children:"Product Slug *"}),e.jsx(A,{as:$,id:"slug",name:"slug",placeholder:"Enter product slug"}),e.jsx(T,{name:"slug",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"description",className:"text-sm font-medium",children:"Description *"}),e.jsx(A,{as:U,id:"description",name:"description",placeholder:"Enter product description",rows:4}),e.jsx(T,{name:"description",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"status",className:"text-sm font-medium",children:"Status *"}),e.jsxs(G,{name:"status",value:i.status,onValueChange:x=>l("status",x),children:[e.jsx(Y,{children:e.jsx(Z,{placeholder:"Select status"})}),e.jsxs(V,{children:[e.jsx(_,{value:"published",children:"Published"}),e.jsx(_,{value:"draft",children:"Draft"})]})]}),e.jsx(T,{name:"status",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"priority",className:"text-sm font-medium",children:"Priority (0-100) *"}),e.jsx(A,{as:$,id:"priority",name:"priority",type:"number",min:"0",max:"100",placeholder:"0"}),e.jsx(T,{name:"priority",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"image",className:"text-sm font-medium",children:"Product Image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:[e.jsx(w,{type:"button",variant:"outline",onClick:()=>j(!0),className:"w-full",children:g?"Change Media":"Add Media"}),e.jsx(z,{routename:route("product.edit",t.id),showModal:c,setShowModal:j,setFieldValue:l,fieldName:"image",setImagePreview:o}),g&&e.jsxs("div",{className:"relative mt-4 inline-block",children:[e.jsx("img",{src:typeof g=="string"?g:URL.createObjectURL(g),alt:"Product Preview",className:"w-24 h-24 object-cover rounded-lg"}),e.jsx(w,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 p-0",onClick:()=>h(l,"image",o),children:e.jsx(F,{className:"h-3 w-3"})})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"thumbnail",className:"text-sm font-medium",children:"Thumbnail Image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:[e.jsx(w,{type:"button",variant:"outline",onClick:()=>R(!0),className:"w-full",children:b?"Change Media":"Add Media"}),e.jsx(z,{routename:route("product.edit",t.id),showModal:f,setShowModal:R,setFieldValue:l,fieldName:"thumbnail",setImagePreview:L}),b&&e.jsxs("div",{className:"relative mt-4 inline-block",children:[e.jsx("img",{src:typeof b=="string"?b:URL.createObjectURL(b),alt:"Thumbnail Preview",className:"w-24 h-24 object-cover rounded-lg"}),e.jsx(w,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 p-0",onClick:()=>h(l,"thumbnail",L),children:e.jsx(F,{className:"h-3 w-3"})})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:"Additional Information"}),Object.keys(m).map(x=>e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("button",{type:"button",className:"w-full px-4 py-3 text-left flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors",onClick:()=>E(x),children:[e.jsx("span",{className:"font-medium capitalize",children:x.replace("_"," ")}),y[x]?e.jsx(ae,{className:"h-4 w-4 transition-transform"}):e.jsx(Q,{className:"h-4 w-4 transition-transform"})]}),y[x]&&e.jsx("div",{className:"p-4 space-y-4 border-t bg-white",children:Object.keys(m[x]).map(d=>{const a=m[x][d],k=`${x}_${d}`;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:k,className:"text-sm font-medium text-gray-700",children:[a.label,a.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),S(x,d,a,i,l)]},d)})})]},x))]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(w,{type:"button",variant:"outline",onClick:()=>q.get(route("product.index")),children:"Cancel"}),e.jsx(w,{type:"submit",disabled:n,children:n?"Updating...":"Update Product"})]})]})})})})})]})}export{Ee as default};
