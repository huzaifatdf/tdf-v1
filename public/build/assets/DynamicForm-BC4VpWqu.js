import{R as h,d as D,r as R,j as a,S as M}from"./app-BgsCCkFb.js";import{b as j,f as G,d as K,e as B,g as H,a as J,c as Q}from"./index.esm-AEbMZ5so.js";import{P}from"./WebsiteLayout-B8SAfw9X.js";import"./toaster-BOkveMJX.js";import"./toast-DXbbVyGG.js";import"./index-TkwlQpn0.js";function ne(_){const[U,W]=h.useState(!0),[u,f]=h.useState(null),[d,y]=h.useState({}),[x,S]=h.useState({}),[X,Y]=h.useState(!1),[C,b]=h.useState({}),[k,q]=h.useState(!1),[N,E]=h.useState({}),{formSlug:O}=_,[v,F]=h.useState(null),L=e=>{const n={};return e.forEach(t=>{var r,c;let s;switch(t.type){case"text":s=j(),t.required&&(s=s.required(`${t.label} is required`)),s=s.min(3,`${t.label} must be at least 3 characters`),s=s.max(255,`${t.label} must be no more than 255 characters`),s=s.matches(/^[^\d]*$/,`${t.label} cannot contain numbers`);break;case"email":s=j().max(255).email("Please enter a valid email address");break;case"url":return a.jsxs("div",{className:t.width==="half"?"w-full md:w-[45%]":"w-full",children:[a.jsx("input",{id:fieldId,type:t.type,value:fieldValue,onChange:l=>m(t.name,l.target.value),placeholder:t.placeholder||t.label,required:t.required,maxLength:t.max_length,minLength:t.min_length,className:`${baseInputClasses} ${errorClasses}`}),fieldError&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:fieldError})]},t.id);case"tel":return a.jsxs("div",{className:t.width==="half"?"w-full md:w-[45%]":"w-full",children:[a.jsx(P,{id:fieldId,international:!0,countryCallingCodeEditable:!1,defaultCountry:"PK",value:fieldValue,onChange:l=>m(t.name,l||""),placeholder:t.placeholder||t.label,className:`phone-input ${errorClasses}`,style:{"--PhoneInput-color":"#ffffff","--PhoneInputInternationalIconPhone-opacity":"0.8","--PhoneInputInternationalIconGlobe-opacity":"0.65","--PhoneInputCountrySelect-marginRight":"0.5rem","--PhoneInputCountrySelectArrow-width":"0.3rem","--PhoneInputCountrySelectArrow-marginLeft":"0.5rem","border-bottom":"1px solid #91a7ba"},numberInputProps:{className:`w-full bg-transparent text-white placeholder-gray-400 border-0 outline-none ${errorClasses}`,style:{background:"transparent",border:"none",outline:"none",color:"white",fontSize:"16px"}},countrySelectProps:{className:"bg-transparent text-black",style:{background:"transparent",border:"none",outline:"none",color:"white"}}}),fieldError&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:fieldError})]},t.id);case"number":s=J().typeError("Please enter a valid number"),t.min!==void 0&&(s=s.min(t.min,`Minimum value is ${t.min}`)),t.max!==void 0&&(s=s.max(t.max,`Maximum value is ${t.max}`));break;case"date":s=H().typeError("Please enter a valid date");break;case"checkbox":t.options&&Object.keys(t.options).length>1?(s=K(),t.required&&(s=s.min(1,`Please select at least one ${t.label.toLowerCase()}`))):(s=B(),t.required&&(s=s.oneOf([!0],`${t.label} is required`)));break;case"radio":s=j();break;case"select":s=j();break;case"file":if(s=G(),t.required&&(s=s.required(`${t.label} is required`)),(r=t.options)!=null&&r.max_size&&(s=s.test("fileSize",`File size must be less than ${t.options.max_size}MB`,l=>!l||l&&l.size<=t.options.max_size*1024*1024)),(c=t.options)!=null&&c.accept){const l=t.options.accept.split(",").map(p=>p.trim());s=s.test("fileType",`File type must be one of: ${l.join(", ")}`,p=>!p||l.some(o=>o==="*"||p.type.includes(o.replace("*",""))))}break;case"textarea":s=j().max(1e3,`${t.label} must be no more than 1000 characters`),t.required&&(s=s.required(`${t.label} is required`));break;default:s=j();break}t.required&&t.type!=="checkbox"&&t.type!=="file"&&(s=s.required(`${t.label} is required`)),t.min_length&&(t.type==="text"||t.type==="textarea")&&(s=s.min(t.min_length,`${t.label} must be at least ${t.min_length} characters`)),t.max_length&&(t.type==="text"||t.type==="textarea")&&(s=s.max(t.max_length,`${t.label} must be no more than ${t.max_length} characters`)),n[t.name]=s}),Q().shape(n)};h.useEffect(()=>{D.get(`/api/v1/form/${O}`).then(e=>{console.log(e.data),f(e.data.form);const n=L(e.data.fields);F(n);const t={},s={};e.data.fields.forEach(r=>{if(r.type==="checkbox"&&r.options?t[r.name]=[]:r.default_value?t[r.name]=r.default_value:t[r.name]="",(r.type==="radio"||r.type==="checkbox")&&r.options&&Object.keys(r.options).length>1){const c=Object.keys(r.options)[0];s[r.name]=c}}),y(t),E(s)}).catch(e=>{console.error("Error fetching form:",e)})},[]);const $=async(e,n)=>{if(v)try{await v.validateAt(e,{[e]:n}),b(t=>({...t,[e]:null}))}catch(t){b(s=>({...s,[e]:t.message}))}},m=(e,n)=>{y(t=>({...t,[e]:n})),C[e]&&b(t=>({...t,[e]:null})),$(e,n)},z=(e,n)=>{n&&(S(t=>({...t,[e]:n})),y(t=>({...t,[e]:n.name}))),$(e,value)},T=(e,n,t)=>{y(s=>{const r=s[e]||[];return t?{...s,[e]:[...r,n]}:{...s,[e]:r.filter(c=>c!==n)}}),$(e,n)},I=(e,n)=>{E(t=>({...t,[e]:n}))},V=async e=>{e.preventDefault(),q(!0),b({});try{if(v){const r={...d};Object.keys(x).forEach(c=>{x[c]&&(r[c]=x[c])}),await v.validate(r,{abortEarly:!1})}const n=new FormData;Object.keys(d).forEach(r=>{Array.isArray(d[r])?d[r].forEach(c=>{n.append(`${r}[]`,c)}):n.append(r,d[r]||"")}),Object.keys(x).forEach(r=>{x[r]&&n.append(r,x[r])});const t=M.post(route("client.submit.form",u.slug),n,{preserveScroll:!0,preserveState:!0,headers:{"Content-Type":"multipart/form-data"}});let s={};u.fields.forEach(r=>{var c;if(r.type==="radio"&&r.options){const l=N==null?void 0:N[r.name],p=((c=r.options)==null?void 0:c[l])||"";s[r.name]=p}else r.type==="checkbox"&&r.options?s[r.name]=[]:s[r.name]=""}),y(s),S({})}catch(n){if(console.error("Form submission error:",n),n.name==="ValidationError"){const t={};n.inner.forEach(s=>{t[s.path]=s.message}),b(t)}else n.response&&n.response.data&&n.response.data.errors?b(n.response.data.errors):alert("There was an error submitting the form. Please try again.")}finally{q(!1)}},A=e=>{var p;const n=d[e.name]||"",t=C[e.name],s=`field-${e.name}`,r=N[e.name],c="w-full bg-transparent ",l=t?"border-red-500":"";switch(e.type){case"text":case"email":case"url":return a.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[a.jsx("input",{id:s,type:e.type,value:n,onChange:o=>m(e.name,o.target.value),placeholder:e.placeholder||e.label,required:e.required,maxLength:e.max_length,minLength:e.min_length,className:`${c} ${l}`}),t&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"tel":return a.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[a.jsx(P,{id:s,international:!0,countryCallingCodeEditable:!1,defaultCountry:"PK",value:n,onChange:o=>m(e.name,o||""),placeholder:e.placeholder||e.label,className:`phone-input ${l}`,style:{"--PhoneInput-color":"#ffffff","--PhoneInputInternationalIconPhone-opacity":"0.8","--PhoneInputInternationalIconGlobe-opacity":"0.65","--PhoneInputCountrySelect-marginRight":"0.5rem","--PhoneInputCountrySelectArrow-width":"0.3rem","--PhoneInputCountrySelectArrow-marginLeft":"0.5rem","border-bottom":"1px solid #91a7ba"},numberInputProps:{className:`w-full bg-transparent text-white placeholder-gray-400 border-0 outline-none ${l}`,style:{background:"transparent",border:"none",outline:"none",color:"white",fontSize:"16px"}},countrySelectProps:{className:"bg-transparent text-black",style:{background:"transparent",border:"none",outline:"none",color:"white"}}}),t&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"number":return a.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[a.jsx("input",{id:s,type:"number",value:n,onChange:o=>m(e.name,o.target.value),placeholder:e.placeholder||e.label,required:e.required,className:`${c} ${l}`}),t&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"textarea":return a.jsxs("div",{className:"w-full",children:[a.jsx("textarea",{id:s,value:n,onChange:o=>m(e.name,o.target.value),placeholder:e.placeholder||e.label,required:e.required,maxLength:e.max_length,minLength:e.min_length,rows:4,className:`${c} ${l}`}),t&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"select":return a.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[a.jsxs("select",{id:s,value:n,onChange:o=>m(e.name,o.target.value),required:e.required,className:`${c} ${l}`,children:[a.jsx("option",{value:"",children:e.placeholder||`Select ${e.label}`}),e.options&&Object.entries(e.options).map(([o,i])=>a.jsx("option",{value:o,children:i},o))]}),t&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"radio":if(e.options&&Object.keys(e.options).length>1){const o=Object.entries(e.options);return a.jsxs("div",{className:"w-full",children:[a.jsx("div",{className:"flex mb-6 mt-6 text-sm",children:o.map(([i,g],w)=>a.jsxs("div",{className:"flex items-center",children:[a.jsxs("button",{type:"button",onClick:()=>{I(e.name,i),m(e.name,g)},className:"flex flex-col items-start pr-6 text-left contact-us-hover",children:[a.jsxs("span",{className:"fc-primary",children:["0",w+1]}),a.jsxs("span",{className:`relative text-[22px] ${r===i?"capitalize fc-secondary":"text-white"}`,children:[g,r===i&&a.jsx("span",{className:"absolute left-0 -bottom-1 w-1/2 border-b-2 border-lime-400"})]})]}),w<o.length-1&&a.jsx("div",{className:"border-r border-gray-600 h-6 mx-3"})]},i))}),a.jsx("div",{className:"mt-4 hidden",children:a.jsxs("label",{className:"flex items-center text-white",children:[a.jsx("input",{type:"hidden",name:e.name,value:r,required:e.required,className:"mr-2"}),"Select ",e.options[r]]})}),t&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id)}else return a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-white mb-2",children:e.label}),a.jsx("div",{className:"space-y-2",children:e.options&&Object.entries(e.options).map(([o,i])=>a.jsxs("label",{className:"flex items-center text-white",children:[a.jsx("input",{type:"radio",name:e.name,value:o,checked:n===o,onChange:g=>m(e.name,g.target.value),required:e.required,className:"mr-2"}),i]},o))}),t&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"checkbox":if(e.options&&Object.keys(e.options).length>1){const o=Object.entries(e.options);return a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-white mb-2",children:e.label}),a.jsx("div",{className:"flex mb-6 mt-6 text-sm",children:o.map(([i,g],w)=>a.jsxs("div",{className:"flex items-center",children:[a.jsxs("button",{type:"button",onClick:()=>I(e.name,i),className:"flex flex-col items-start pr-6 text-left",children:[a.jsxs("span",{className:"fc-primary",children:["0",w+1]}),a.jsxs("span",{className:`relative text-[18px] ${r===i?"fc-secondary":"text-white"}`,children:[g,r===i&&a.jsx("span",{className:"absolute left-0 -bottom-1 w-1/2 border-b-2 border-lime-400"})]})]}),w<o.length-1&&a.jsx("div",{className:"border-r border-gray-600 h-6 mx-3"})]},i))}),a.jsx("div",{className:"mt-4",children:a.jsxs("label",{className:"flex items-center text-white",children:[a.jsx("input",{type:"checkbox",checked:(n||[]).includes(r),onChange:i=>T(e.name,r,i.target.checked),className:"mr-2"}),"Select ",e.options[r]]})}),n&&n.length>0&&a.jsx("div",{className:"mt-2",children:a.jsxs("p",{className:"text-sm text-gray-400",children:["Selected: ",n.map(i=>e.options[i]).join(", ")]})}),t&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id)}else return a.jsxs("div",{className:"w-full",children:[a.jsxs("label",{className:"flex items-center text-white",children:[a.jsx("input",{type:"checkbox",checked:!!n,onChange:o=>m(e.name,o.target.checked),className:"mr-2"}),e.placeholder||e.label]}),t&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"file":return a.jsxs("div",{className:"w-full",children:[a.jsx("label",{className:"block text-white mb-2",children:e.label}),a.jsx("input",{id:s,type:"file",onChange:o=>z(e.name,o.target.files[0]),required:e.required,accept:((p=e.options)==null?void 0:p.accept)||"*",className:"w-full p-3 bg-transparent border border-gray-600 rounded-md text-white file:bg-purple-600 file:text-white file:border-none file:rounded file:px-4 file:py-2 file:mr-4"}),x[e.name]&&a.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Selected: ",x[e.name].name]}),t&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"date":return a.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[a.jsx("input",{id:s,type:"date",value:n,onChange:o=>m(e.name,o.target.value),required:e.required,className:`${c} ${l}`}),t&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id);case"hidden":return a.jsx("input",{type:"hidden",name:e.name,value:n||e.default_value||""},e.id);default:return a.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[a.jsx("input",{id:s,type:"text",value:n,onChange:o=>m(e.name,o.target.value),placeholder:e.placeholder||e.label,required:e.required,className:`${c} ${l}`}),t&&a.jsx("p",{className:"text-red-500 text-sm mt-1",children:t})]},e.id)}};return R.useEffect(()=>{u&&u.fields&&u.fields.forEach(e=>{(e.type==="radio"||e.type==="checkbox")&&e.options&&m(e.name,e.options[0])})},[u]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:"",children:[u&&u.fields&&a.jsx("form",{onSubmit:V,className:"",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-6 py-6 transform transition-transform duration-500 ease-in-out",children:[a.jsx("div",{className:"flex flex-col md:flex-row md:flex-wrap gap-4 text-white justify-between",children:u.fields.map(e=>A(e))}),a.jsxs("button",{type:"submit",disabled:k,className:"group flex items-center justify-content-end gap-2 bg-transparent border-none fc-primary transition-colors duration-300 text-lg font-medium cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:[k?"Submitting...":u.submit_button_text||"Submit",a.jsx("span",{className:"fc-purple group-hover:translate-x-1 transition-transform",children:"→"})]})]})}),!u&&a.jsx("div",{className:"flex items-center justify-center text-white",children:a.jsx("p",{children:"Loading form..."})})]})})}export{ne as default};
