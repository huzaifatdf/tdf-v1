import{r as s,j as e,R as U,q as B,m as D,$ as J}from"./app-CGI_v39D.js";import{A as W}from"./AuthenticatedLayout-DWeWA4zT.js";import{B as b,i as C,X as z,t as K}from"./toast-KhC6K5vt.js";import{T as O}from"./textarea-CJiBwZxu.js";import{S as Q,a as X,b as G,c as Y,d as q}from"./select-94kBya1e.js";import{c as Z,g as V,b as L,F as ee,d as te,e as I,E as k}from"./index.esm-_ge17A_K.js";import A from"./Model-DF3w-lr7.js";import{C as se}from"./chevron-down-DBSL8fTO.js";import"./createLucideIcon-BwiqzFXL.js";import"./index-Diua5JYI.js";import"./index-D58_IWEd.js";import"./alert-BrDexE4o.js";import"./Modal-L0Sjde4w.js";import"./transition-DvsM_m-J.js";import"./search-CNhUqEKb.js";import"./trash-2-pZlvEj2L.js";import"./video-YJ3SY9fK.js";import"./upload-DytwsDmD.js";import"./download-DOW8L-3x.js";import"./eye-BpFHZggV.js";const P=new Set,T=(t,l="script")=>new Promise((h,m)=>{if(P.has(t)){h();return}const n=l==="script"?document.createElement("script"):document.createElement("link");l==="script"?(n.src=t,n.onload=()=>{P.add(t),h()},n.onerror=m):(n.rel="stylesheet",n.href=t,n.onload=()=>{P.add(t),h()},n.onerror=m),document.head.appendChild(n)}),F=U.memo(({value:t,onChange:l,placeholder:h,height:m=200})=>{const n=s.useRef(null),[d,v]=s.useState(t||""),f=s.useCallback(i=>{const j=i.target.innerHTML;v(j),l(j)},[l]),g=s.useCallback(i=>{if(i.ctrlKey||i.metaKey)switch(i.key){case"b":i.preventDefault(),document.execCommand("bold");break;case"i":i.preventDefault(),document.execCommand("italic");break;case"u":i.preventDefault(),document.execCommand("underline");break}},[]),a=s.useCallback((i,j=null)=>{var w;document.execCommand(i,!1,j),(w=n.current)==null||w.focus()},[]);return s.useEffect(()=>{n.current&&d!==n.current.innerHTML&&(n.current.innerHTML=d)},[d]),e.jsxs("div",{className:"border rounded-md overflow-hidden",children:[e.jsxs("div",{className:"border-b p-2 bg-gray-50 flex gap-1 flex-wrap",children:[e.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:()=>a("bold"),className:"px-2 py-1 text-xs h-8",title:"Bold (Ctrl+B)",children:e.jsx("strong",{children:"B"})}),e.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:()=>a("italic"),className:"px-2 py-1 text-xs h-8",title:"Italic (Ctrl+I)",children:e.jsx("em",{children:"I"})}),e.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:()=>a("underline"),className:"px-2 py-1 text-xs h-8",title:"Underline (Ctrl+U)",children:e.jsx("u",{children:"U"})}),e.jsx("div",{className:"w-px bg-gray-300 mx-1"}),e.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:()=>a("insertUnorderedList"),className:"px-2 py-1 text-xs h-8",title:"Bullet List",children:"â€¢"}),e.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:()=>a("insertOrderedList"),className:"px-2 py-1 text-xs h-8",title:"Numbered List",children:"1."}),e.jsx("div",{className:"w-px bg-gray-300 mx-1"}),e.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:()=>a("createLink",prompt("Enter URL:")),className:"px-2 py-1 text-xs h-8",title:"Insert Link",children:"ðŸ”—"}),e.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:()=>a("removeFormat"),className:"px-2 py-1 text-xs h-8",title:"Clear Formatting",children:"âœ•"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{ref:n,contentEditable:!0,onInput:f,onKeyDown:g,className:"p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset",style:{minHeight:`${m}px`,wordBreak:"break-word",lineHeight:"1.5"},dangerouslySetInnerHTML:{__html:d},suppressContentEditableWarning:!0}),!d&&e.jsx("div",{className:"absolute top-3 left-3 pointer-events-none text-gray-400 select-none",style:{lineHeight:"1.5"},children:h||"Enter content..."})]})]})});F.displayName="SimpleRichTextEditor";const _=U.memo(({value:t,onChange:l,placeholder:h,height:m=200})=>{const n=s.useRef(null),[d,v]=s.useState(!1),f=s.useRef(!0),g=s.useCallback(a=>{f.current&&l(a)},[l]);return s.useEffect(()=>{if(!d||!n.current||!window.$||!window.$.fn.summernote)return;const a=window.$(n.current);let i=!1;return(()=>{i||(a.summernote({placeholder:h||"Enter content...",tabsize:2,height:m,toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],callbacks:{onChange:g,onInit:function(){t&&f.current&&a.summernote("code",t)}}}),i=!0,t&&a.summernote("code",t))})(),()=>{i&&a.data("summernote")&&a.summernote("destroy")}},[d,t,g,h,m]),s.useEffect(()=>{if(d&&n.current&&window.$&&window.$.fn.summernote){const a=window.$(n.current);a.data("summernote")&&a.summernote("code")!==t&&f.current&&a.summernote("code",t||"")}},[t,d]),s.useEffect(()=>{const a=()=>{window.$&&window.$.fn.summernote&&f.current&&v(!0)};a();const i=setInterval(a,100);return()=>{clearInterval(i),f.current=!1}},[]),d?e.jsx("div",{className:"summernote-wrapper",children:e.jsx("textarea",{ref:n,className:"form-control",style:{display:"none"},defaultValue:t||""})}):e.jsxs("div",{className:"border rounded-md p-4 bg-gray-50 flex items-center justify-center",style:{height:`${m+40}px`},children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Initializing editor..."})]})});_.displayName="AdvancedSummernoteEditor";const ae=({value:t="",onChange:l,placeholder:h="Enter content...",height:m=200,className:n="",disabled:d=!1,showToggle:v=!0,defaultMode:f="simple"})=>{const[g,a]=s.useState(f),[i,j]=s.useState(!1),[w,S]=s.useState(!1);s.useEffect(()=>{window.$&&window.$.fn.summernote&&S(!0)},[]);const E=s.useCallback(async()=>{if(!(i||w)){j(!0);try{window.jQuery||await T("https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"),await Promise.all([T("https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-lite.min.css","link"),T("https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-lite.min.js")]),S(!0),a("advanced")}catch($){console.error("Failed to load Summernote:",$)}finally{j(!1)}}},[i,w]),M=s.useCallback(()=>{g==="simple"?w?a("advanced"):E():a("simple")},[g,w,E]);return d?e.jsx("div",{className:`border rounded-md p-3 bg-gray-50 ${n}`,style:{minHeight:`${m}px`},dangerouslySetInnerHTML:{__html:t||`<span class="text-gray-400">${h}</span>`}}):e.jsxs("div",{className:`summernote-input-wrapper ${n}`,children:[v&&e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["Editor: ",g==="simple"?"Simple":"Advanced"]}),e.jsx(b,{type:"button",variant:"ghost",size:"sm",onClick:M,disabled:i,className:"text-xs h-6 px-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-current mr-1"}),"Loading..."]}):`Switch to ${g==="simple"?"Advanced":"Simple"}`})]}),g==="simple"?e.jsx(F,{value:t,onChange:l,placeholder:h,height:m}):e.jsx(_,{value:t,onChange:l,placeholder:h,height:m})]})};function Ce(){const{product:t,additionalDataStructure:l,appUrl:h}=B().props,[m,n]=s.useState(h+"/"+t.image||null),[d,v]=s.useState(h+"/"+t.thumbnail||null),[f,g]=s.useState({Detail:!1,"Our Work":!1,Problem:!1,"problem Solutions":!1,seo:!1}),a=Z({title:L().required("Title is required").min(2,"Title must be at least 2 characters").max(255,"Title must not exceed 255 characters"),slug:L().required("Slug is required").matches(/^[a-z0-9-]+$/,"Slug can only contain lowercase letters, numbers, and hyphens"),description:L().required("Description is required").min(10,"Description must be at least 10 characters"),status:L().required("Status is required").oneOf(["published","draft"],"Invalid status"),priority:V().required("Priority is required").min(0,"Priority must be at least 0").max(100,"Priority must not exceed 100")}),i=s.useCallback((c,{setSubmitting:u})=>{const o=new FormData;["title","slug","description","status","priority"].forEach(r=>{o.append(r,c[r])}),o.append("image",c.image),o.append("thumbnail",c.thumbnail);const p={};Object.keys(l).forEach(r=>{p[r]={},Object.keys(l[r]).forEach(N=>{const y=`${r}_${N}`;c[y]!==void 0&&c[y]!==""&&(p[r][N]=c[y])}),Object.keys(p[r]).length===0&&delete p[r]}),Object.keys(p).length>0&&o.append("additional_data",JSON.stringify(p)),o.append("_method","PUT"),D.post(route("product.update",t.id),o,{forceFormData:!0,onSuccess:()=>u(!1),onError:()=>u(!1)})},[t.id,l]),j=s.useCallback((c,u,o)=>{c(u,null),o(null)},[]),w=s.useCallback(c=>{g(u=>({...u,[c]:!u[c]}))},[]),S=s.useCallback((c,u,o,x,p)=>{const r=`${c}_${u}`,N=x[r]||"";switch(o.type){case"summernote":return e.jsx(ae,{value:N,onChange:y=>p(r,y),placeholder:`Enter ${o.label.toLowerCase()}`,height:200,showToggle:!0,defaultMode:"simple"});case"textarea":return e.jsx(O,{id:r,name:r,value:N,onChange:y=>p(r,y.target.value),placeholder:`Enter ${o.label.toLowerCase()}`,rows:3});case"number":return e.jsx(C,{id:r,name:r,type:"number",value:N,onChange:y=>p(r,y.target.value),placeholder:`Enter ${o.label.toLowerCase()}`,step:"0.01"});default:return e.jsx(C,{id:r,name:r,type:"text",value:N,onChange:y=>p(r,y.target.value),placeholder:`Enter ${o.label.toLowerCase()}`})}},[]),E=s.useCallback(()=>{const c={title:t.title||"",slug:t.slug||"",description:t.description||"",image:t.image||null,thumbnail:t.thumbnail||null,status:t.status||"",priority:t.priority||0},u=t.data?JSON.parse(t.data):{};return Object.keys(l).forEach(o=>{Object.keys(l[o]).forEach(x=>{var r;const p=`${o}_${x}`;c[p]=((r=u[o])==null?void 0:r[x])||""})}),c},[t,l]),[M,$]=s.useState(!1),[H,R]=s.useState(!1);return e.jsxs(W,{children:[e.jsx(J,{title:`Edit Product - ${t.title}`}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx("div",{className:"@container/main flex flex-1 flex-col gap-2 p-10",children:e.jsx("div",{className:"w-full",children:e.jsx(ee,{initialValues:E(),validationSchema:a,onSubmit:i,children:({isSubmitting:c,setFieldValue:u,values:o})=>e.jsxs(te,{className:"space-y-6 bg-white p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Edit Product"}),e.jsx("p",{className:"text-gray-600",children:"Update product information"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"title",className:"text-sm font-medium",children:"Product Title *"}),e.jsx(I,{as:C,id:"title",name:"title",placeholder:"Enter product title"}),e.jsx(k,{name:"title",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"slug",className:"text-sm font-medium",children:"Product Slug *"}),e.jsx(I,{as:C,id:"slug",name:"slug",placeholder:"Enter product slug"}),e.jsx(k,{name:"slug",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"description",className:"text-sm font-medium",children:"Description *"}),e.jsx(I,{as:O,id:"description",name:"description",placeholder:"Enter product description",rows:4}),e.jsx(k,{name:"description",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"status",className:"text-sm font-medium",children:"Status *"}),e.jsxs(Q,{name:"status",value:o.status,onValueChange:x=>u("status",x),children:[e.jsx(X,{children:e.jsx(G,{placeholder:"Select status"})}),e.jsxs(Y,{children:[e.jsx(q,{value:"published",children:"Published"}),e.jsx(q,{value:"draft",children:"Draft"})]})]}),e.jsx(k,{name:"status",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"priority",className:"text-sm font-medium",children:"Priority (0-100) *"}),e.jsx(I,{as:C,id:"priority",name:"priority",type:"number",min:"0",max:"100",placeholder:"0"}),e.jsx(k,{name:"priority",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"image",className:"text-sm font-medium",children:"Product Image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>$(!0),className:"w-full",children:m?"Change Media":"Add Media"}),e.jsx(A,{routename:route("product.edit",t.id),showModal:M,setShowModal:$,setFieldValue:u,fieldName:"image",setImagePreview:n}),m&&e.jsxs("div",{className:"relative mt-4 inline-block",children:[e.jsx("img",{src:typeof m=="string"?m:URL.createObjectURL(m),alt:"Product Preview",className:"w-24 h-24 object-cover rounded-lg"}),e.jsx(b,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 p-0",onClick:()=>j(u,"image",n),children:e.jsx(z,{className:"h-3 w-3"})})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"thumbnail",className:"text-sm font-medium",children:"Thumbnail Image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>R(!0),className:"w-full",children:d?"Change Media":"Add Media"}),e.jsx(A,{routename:route("product.edit",t.id),showModal:H,setShowModal:R,setFieldValue:u,fieldName:"thumbnail",setImagePreview:v}),d&&e.jsxs("div",{className:"relative mt-4 inline-block",children:[e.jsx("img",{src:typeof d=="string"?d:URL.createObjectURL(d),alt:"Thumbnail Preview",className:"w-24 h-24 object-cover rounded-lg"}),e.jsx(b,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 p-0",onClick:()=>j(u,"thumbnail",v),children:e.jsx(z,{className:"h-3 w-3"})})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:"Additional Information"}),Object.keys(l).map(x=>e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("button",{type:"button",className:"w-full px-4 py-3 text-left flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors",onClick:()=>w(x),children:[e.jsx("span",{className:"font-medium capitalize",children:x.replace("_"," ")}),f[x]?e.jsx(se,{className:"h-4 w-4 transition-transform"}):e.jsx(K,{className:"h-4 w-4 transition-transform"})]}),f[x]&&e.jsx("div",{className:"p-4 space-y-4 border-t bg-white",children:Object.keys(l[x]).map(p=>{const r=l[x][p],N=`${x}_${p}`;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:N,className:"text-sm font-medium text-gray-700",children:[r.label,r.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),S(x,p,r,o,u)]},p)})})]},x))]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>D.get(route("product.index")),children:"Cancel"}),e.jsx(b,{type:"submit",disabled:c,children:c?"Updating...":"Update Product"})]})]})})})})})]})}export{Ce as default};
