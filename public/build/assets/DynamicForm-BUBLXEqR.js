import{R as p,r as f,d as P,j as t,m as B}from"./app-BBTo_GfT.js";function z(L){const[E,M]=p.useState(!0),[i,I]=p.useState(null),[g,b]=p.useState({}),[j,k]=p.useState({}),[V,W]=p.useState(!1),[u,N]=p.useState({}),[A,C]=p.useState(!1),[y,q]=p.useState({}),{formSlug:O}=L,[R,$]=p.useState(!0),[h,S]=p.useState(null);f.useEffect(()=>{if(window.grecaptcha){$(!0);return}const e=document.createElement("script");return e.src="https://www.google.com/recaptcha/api.js?onload=onRecaptchaLoad&render=explicit",e.async=!0,e.defer=!0,window.onRecaptchaLoad=()=>{$(!0)},document.head.appendChild(e),()=>{document.head.contains(e)&&document.head.removeChild(e),delete window.onRecaptchaLoad}},[]),f.useEffect(()=>{if(R&&E&&window.grecaptcha){const e=document.getElementById("recaptcha-container");e&&(e.innerHTML=""),h!==null&&S(null);const a=setTimeout(()=>{try{const s=window.grecaptcha.render("recaptcha-container",{sitekey:"6Ld8o3MrAAAAAI2wRjHqNBz7vJ9JAuDUWrIgl-Ry",callback:n=>{console.log("reCAPTCHA completed:",n)},"expired-callback":()=>{console.log("reCAPTCHA expired")},"error-callback":()=>{console.log("reCAPTCHA error")}});S(s)}catch(s){console.error("Error rendering reCAPTCHA:",s)}},100);return()=>{clearTimeout(a)}}if(!E&&h!==null){const e=document.getElementById("recaptcha-container");e&&(e.innerHTML=""),S(null)}},[]),f.useEffect(()=>()=>{if(h!==null){const e=document.getElementById("recaptcha-container");e&&(e.innerHTML="")}},[]),p.useEffect(()=>{P.get(`/api/v1/form/${O}`).then(e=>{console.log(e.data),I(e.data.form);const a={},s={};e.data.fields.forEach(n=>{if(n.type==="checkbox"&&n.options?a[n.name]=[]:n.default_value?a[n.name]=n.default_value:a[n.name]="",(n.type==="radio"||n.type==="checkbox")&&n.options&&Object.keys(n.options).length>1){const o=Object.keys(n.options)[0];s[n.name]=o}}),b(a),q(s)}).catch(e=>{console.error("Error fetching form:",e)})},[]);const d=(e,a)=>{b(s=>({...s,[e]:a})),u[e]&&N(s=>({...s,[e]:null}))},D=(e,a)=>{a&&(k(s=>({...s,[e]:a})),b(s=>({...s,[e]:a.name})))},F=(e,a,s)=>{b(n=>{const o=n[e]||[];return s?{...n,[e]:[...o,a]}:{...n,[e]:o.filter(c=>c!==a)}})},T=(e,a)=>{q(s=>({...s,[e]:a}))},H=async e=>{e.preventDefault(),C(!0),N({});try{let a="";if(window.grecaptcha&&h!==null&&(a=window.grecaptcha.getResponse(h)),!a){N({"g-recaptcha-response":["Please complete the reCAPTCHA verification."]}),C(!1);return}const s=new FormData;Object.keys(g).forEach(c=>{Array.isArray(g[c])?g[c].forEach(m=>{s.append(`${c}[]`,m)}):s.append(c,g[c]||"")}),Object.keys(j).forEach(c=>{j[c]&&s.append(c,j[c])}),s.append("g-recaptcha-response",a);const n=B.post(route("client.submit.form",i.slug),s,{preserveScroll:!0,preserveState:!0,headers:{"Content-Type":"multipart/form-data"}});let o={};i.fields.forEach(c=>{var m;if(c.type==="radio"&&c.options){const v=y==null?void 0:y[c.name],r=((m=c.options)==null?void 0:m[v])||"";o[c.name]=r}else c.type==="checkbox"&&c.options?o[c.name]=[]:o[c.name]=""}),b(o),k({}),window.grecaptcha&&h!==null&&window.grecaptcha.reset(h)}catch(a){console.error("Form submission error:",a),window.grecaptcha&&h!==null&&window.grecaptcha.reset(h),a.response&&a.response.data&&a.response.data.errors?N(a.response.data.errors):alert("There was an error submitting the form. Please try again.")}finally{C(!1)}},_=e=>{var v;const a=g[e.name]||"",s=u[e.name],n=`field-${e.name}`,o=y[e.name],c="w-full bg-transparent ",m=s?"border-red-500":"";switch(e.type){case"text":case"email":case"url":case"tel":return t.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[t.jsx("input",{id:n,type:e.type,value:a,onChange:r=>d(e.name,r.target.value),placeholder:e.placeholder||e.label,required:e.required,maxLength:e.max_length,minLength:e.min_length,className:`${c} ${m}`}),s&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:s})]},e.id);case"number":return t.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[t.jsx("input",{id:n,type:"number",value:a,onChange:r=>d(e.name,r.target.value),placeholder:e.placeholder||e.label,required:e.required,className:`${c} ${m}`}),s&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:s})]},e.id);case"textarea":return t.jsxs("div",{className:"w-full",children:[t.jsx("textarea",{id:n,value:a,onChange:r=>d(e.name,r.target.value),placeholder:e.placeholder||e.label,required:e.required,maxLength:e.max_length,minLength:e.min_length,rows:4,className:`${c} ${m}`}),s&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:s})]},e.id);case"select":return t.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[t.jsxs("select",{id:n,value:a,onChange:r=>d(e.name,r.target.value),required:e.required,className:`${c} ${m}`,children:[t.jsx("option",{value:"",children:e.placeholder||`Select ${e.label}`}),e.options&&Object.entries(e.options).map(([r,l])=>t.jsx("option",{value:r,children:l},r))]}),s&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:s})]},e.id);case"radio":if(e.options&&Object.keys(e.options).length>1){const r=Object.entries(e.options);return t.jsxs("div",{className:"w-full",children:[t.jsx("div",{className:"flex mb-6 mt-6 text-sm",children:r.map(([l,x],w)=>t.jsxs("div",{className:"flex items-center",children:[t.jsxs("button",{type:"button",onClick:()=>{T(e.name,l),d(e.name,x)},className:"flex flex-col items-start pr-6 text-left",children:[t.jsxs("span",{className:"fc-primary",children:["0",w+1]}),t.jsxs("span",{className:`relative text-[22px] ${o===l?"fc-secondary":"text-white"}`,children:[x,o===l&&t.jsx("span",{className:"absolute left-0 -bottom-1 w-1/2 border-b-2 border-lime-400"})]})]}),w<r.length-1&&t.jsx("div",{className:"border-r border-gray-600 h-6 mx-3"})]},l))}),t.jsx("div",{className:"mt-4 hidden",children:t.jsxs("label",{className:"flex items-center text-white",children:[t.jsx("input",{type:"hidden",name:e.name,value:o,required:e.required,className:"mr-2"}),"Select ",e.options[o]]})}),s&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:s})]},e.id)}else return t.jsxs("div",{className:"w-full",children:[t.jsx("label",{className:"block text-white mb-2",children:e.label}),t.jsx("div",{className:"space-y-2",children:e.options&&Object.entries(e.options).map(([r,l])=>t.jsxs("label",{className:"flex items-center text-white",children:[t.jsx("input",{type:"radio",name:e.name,value:r,checked:a===r,onChange:x=>d(e.name,x.target.value),required:e.required,className:"mr-2"}),l]},r))}),s&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:s})]},e.id);case"checkbox":if(e.options&&Object.keys(e.options).length>1){const r=Object.entries(e.options);return t.jsxs("div",{className:"w-full",children:[t.jsx("label",{className:"block text-white mb-2",children:e.label}),t.jsx("div",{className:"flex mb-6 mt-6 text-sm",children:r.map(([l,x],w)=>t.jsxs("div",{className:"flex items-center",children:[t.jsxs("button",{type:"button",onClick:()=>T(e.name,l),className:"flex flex-col items-start pr-6 text-left",children:[t.jsxs("span",{className:"fc-primary",children:["0",w+1]}),t.jsxs("span",{className:`relative text-[18px] ${o===l?"fc-secondary":"text-white"}`,children:[x,o===l&&t.jsx("span",{className:"absolute left-0 -bottom-1 w-1/2 border-b-2 border-lime-400"})]})]}),w<r.length-1&&t.jsx("div",{className:"border-r border-gray-600 h-6 mx-3"})]},l))}),t.jsx("div",{className:"mt-4",children:t.jsxs("label",{className:"flex items-center text-white",children:[t.jsx("input",{type:"checkbox",checked:(a||[]).includes(o),onChange:l=>F(e.name,o,l.target.checked),className:"mr-2"}),"Select ",e.options[o]]})}),a&&a.length>0&&t.jsx("div",{className:"mt-2",children:t.jsxs("p",{className:"text-sm text-gray-400",children:["Selected: ",a.map(l=>e.options[l]).join(", ")]})}),s&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:s})]},e.id)}else return t.jsxs("div",{className:"w-full",children:[t.jsxs("label",{className:"flex items-center text-white",children:[t.jsx("input",{type:"checkbox",checked:!!a,onChange:r=>d(e.name,r.target.checked),className:"mr-2"}),e.placeholder||e.label]}),s&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:s})]},e.id);case"file":return t.jsxs("div",{className:"w-full",children:[t.jsx("label",{className:"block text-white mb-2",children:e.label}),t.jsx("input",{id:n,type:"file",onChange:r=>D(e.name,r.target.files[0]),required:e.required,accept:((v=e.options)==null?void 0:v.accept)||"*",className:"w-full p-3 bg-transparent border border-gray-600 rounded-md text-white file:bg-purple-600 file:text-white file:border-none file:rounded file:px-4 file:py-2 file:mr-4"}),j[e.name]&&t.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Selected: ",j[e.name].name]}),s&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:s})]},e.id);case"date":return t.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[t.jsx("input",{id:n,type:"date",value:a,onChange:r=>d(e.name,r.target.value),required:e.required,className:`${c} ${m}`}),s&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:s})]},e.id);case"hidden":return t.jsx("input",{type:"hidden",name:e.name,value:a||e.default_value||""},e.id);default:return t.jsxs("div",{className:e.width==="half"?"w-full md:w-[45%]":"w-full",children:[t.jsx("input",{id:n,type:"text",value:a,onChange:r=>d(e.name,r.target.value),placeholder:e.placeholder||e.label,required:e.required,className:`${c} ${m}`}),s&&t.jsx("p",{className:"text-red-500 text-sm mt-1",children:s})]},e.id)}};return f.useEffect(()=>{i&&i.fields&&i.fields.forEach(e=>{(e.type==="radio"||e.type==="checkbox")&&e.options&&d(e.name,e.options[0])})},[i]),t.jsx(t.Fragment,{children:t.jsxs("div",{className:"",children:[i&&i.fields&&t.jsx("form",{onSubmit:H,className:"",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-6 py-6 transform transition-transform duration-500 ease-in-out",children:[t.jsxs("div",{className:"flex flex-col md:flex-row md:flex-wrap gap-4 text-white justify-between",children:[i.fields.map(e=>_(e)),t.jsxs("div",{className:"w-full",children:[t.jsx("div",{id:"recaptcha-container",className:"flex justify-start"}),u["g-recaptcha-response"]&&t.jsx("p",{className:"text-red-500 text-sm mt-2",children:Array.isArray(u["g-recaptcha-response"])?u["g-recaptcha-response"][0]:u["g-recaptcha-response"]})]})]}),t.jsxs("button",{type:"submit",disabled:A,className:"group flex items-center justify-content-end gap-2 bg-transparent border-none fc-primary transition-colors duration-300 text-lg font-medium cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed",children:[A?"Submitting...":i.submit_button_text||"Submit",t.jsx("span",{className:"fc-purple group-hover:translate-x-1 transition-transform",children:"→"})]})]})}),!i&&t.jsx("div",{className:"flex items-center justify-center text-white",children:t.jsx("p",{children:"Loading form..."})})]})})}export{z as default};
