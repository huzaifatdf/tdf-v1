import{J as W,r as g,j as e,Q as U,S as b}from"./app-CBd2YLqH.js";import{A as G}from"./AuthenticatedLayout-rUCjeu9E.js";import{B as m,I as c}from"./breadcrumb-Btcl-kqj.js";import{T as u}from"./textarea-DaWLppv3.js";import{S as v,a as f,b as _,c as F,d as y}from"./select-BRHunxH1.js";import{C as S,a as C,b as $,c as q}from"./card-C41tfU_Y.js";import{D as H,a as M,b as Q,c as J,d as Y}from"./dialog-DPFRd5Rj.js";import{L as r}from"./label-CVrZ9vo7.js";import{S as K}from"./switch-BrchjWjd.js";import{T as X,a as Z,b as w,c as T}from"./tabs-BNLCBAfq.js";import{F as V,a as ee,b as d,E as N,c as se}from"./formik.esm-D10cgmA2.js";import{c as E,d as le,b as h}from"./index.esm-CktuVFLH.js";import{P as ae}from"./plus-BstKXHmW.js";import{G as te}from"./grip-vertical-CFiwi5Vi.js";import{S as ie}from"./settings-C5SCS9mQ.js";import{T as re}from"./trash-2-vhgmX_d0.js";import{E as ne}from"./eye-DWoXD1H4.js";import"./toast-r8C7kUxE.js";import"./index-5_oCVjDJ.js";import"./toaster-JlEkunPl.js";import"./index-D0fEUlEP.js";import"./chevron-down-3Q0-v2Ol.js";const ce=[{value:"text",label:"Text"},{value:"email",label:"Email"},{value:"number",label:"Number"},{value:"tel",label:"Telephone"},{value:"url",label:"URL"},{value:"textarea",label:"Textarea"},{value:"select",label:"Select Dropdown"},{value:"radio",label:"Radio Button"},{value:"checkbox",label:"Checkbox"},{value:"date",label:"Date"},{value:"file",label:"File Upload"},{value:"hidden",label:"Hidden Field"}],oe=[{value:"full",label:"Full Width"},{value:"half",label:"Half Width"},{value:"third",label:"Third Width"}];function ke(){const{form:t}=W().props,[k,D]=g.useState("form-settings"),[O,p]=g.useState(null),[L,j]=g.useState(!1),I=E({name:h().required("Form name is required").min(2,"Name must be at least 2 characters"),slug:h().required("Slug is required").matches(/^[a-z0-9-]+$/,"Slug can only contain lowercase letters, numbers, and hyphens"),submit_button_text:h().required("Submit button text is required"),success_message:h().required("Success message is required"),fields:le().of(E({name:h().required("Field name is required"),label:h().required("Field label is required"),type:h().required("Field type is required")})).min(1,"At least one field is required")}),A=()=>({name:t.name||"",description:t.description||"",slug:t.slug||"",submit_button_text:t.submit_button_text||"Submit",success_message:t.success_message||"Thank you for your submission!",redirect_url:t.redirect_url||"",notification_email:t.notification_email||"",alternative_email:t.alternative_email||"",info_email:t.info_email||"",email_subject:t.email_subject||"",status:t.status||"active",require_captcha:t.require_captcha||!1,store_submissions:t.store_submissions!==!1,fields:t.fields?t.fields.map(l=>({id:l.id,name:l.name,label:l.label,type:l.type,placeholder:l.placeholder||"",default_value:l.default_value||"",help_text:l.help_text||"",required:l.required||!1,max_length:l.max_length||null,min_length:l.min_length||null,options:l.options||[],sort_order:l.sort_order||0,width:l.width||"full"})):[]}),z=(l,{setSubmitting:a,resetForm:i})=>{!l.slug&&l.name&&(l.slug=l.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")),b.put(route("form.update",t.id),l,{onSuccess:()=>{a(!1)},onError:s=>{a(!1),console.error("Form submission errors:",s)}})},B=(l,a="text")=>{const i={name:`field_${Date.now()}`,label:"New Field",type:a,placeholder:"",default_value:"",help_text:"",required:!1,max_length:null,min_length:null,options:[],sort_order:l.form.values.fields.length,width:"full"};l.push(i),p(l.form.values.fields.length),j(!0)},P=(l,a)=>{l.remove(a)},R=({field:l,index:a,setFieldValue:i})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:`fields.${a}.name`,children:"Field Name"}),e.jsx(c,{id:`fields.${a}.name`,value:l.name,onChange:s=>i(`fields.${a}.name`,s.target.value),placeholder:"field_name"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:`fields.${a}.label`,children:"Field Label"}),e.jsx(c,{id:`fields.${a}.label`,value:l.label,onChange:s=>i(`fields.${a}.label`,s.target.value),placeholder:"Field Label"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:`fields.${a}.type`,children:"Field Type"}),e.jsxs(v,{value:l.type,onValueChange:s=>i(`fields.${a}.type`,s),children:[e.jsx(f,{children:e.jsx(_,{})}),e.jsx(F,{children:ce.map(s=>e.jsx(y,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:`fields.${a}.width`,children:"Width"}),e.jsxs(v,{value:l.width,onValueChange:s=>i(`fields.${a}.width`,s),children:[e.jsx(f,{children:e.jsx(_,{})}),e.jsx(F,{children:oe.map(s=>e.jsx(y,{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:`fields.${a}.placeholder`,children:"Placeholder"}),e.jsx(c,{id:`fields.${a}.placeholder`,value:l.placeholder||"",onChange:s=>i(`fields.${a}.placeholder`,s.target.value),placeholder:"Enter placeholder text"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:`fields.${a}.help_text`,children:"Help Text"}),e.jsx(c,{id:`fields.${a}.help_text`,value:l.help_text||"",onChange:s=>i(`fields.${a}.help_text`,s.target.value),placeholder:"Optional help text"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(K,{id:`fields.${a}.required`,checked:l.required||!1,onCheckedChange:s=>i(`fields.${a}.required`,s)}),e.jsx(r,{htmlFor:`fields.${a}.required`,children:"Required Field"})]}),["select","radio","checkbox"].includes(l.type)&&e.jsxs("div",{children:[e.jsx(r,{children:"Options (one per line)"}),e.jsx(u,{value:l.options?l.options.join(`
`):"",onChange:s=>{const n=s.target.value.split(`
`).filter(o=>o.trim());i(`fields.${a}.options`,n)},placeholder:`Option 1
Option 2
Option 3`,rows:4})]})]});return e.jsxs(G,{children:[e.jsx(U,{title:`Edit Form - ${t.name}`}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsxs("div",{className:"@container/main flex flex-1 flex-col gap-2 p-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h1",{className:"text-3xl font-bold",children:["Edit Form: ",t.name]}),e.jsx(m,{variant:"outline",onClick:()=>b.get(route("form.index")),children:"Back to Forms"})]}),e.jsx(V,{initialValues:A(),validationSchema:I,onSubmit:z,children:({isSubmitting:l,setFieldValue:a,values:i})=>e.jsxs(ee,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(S,{children:[e.jsx(C,{children:e.jsx($,{children:"Form Builder"})}),e.jsx(q,{children:e.jsxs(X,{value:k,onValueChange:D,children:[e.jsxs(Z,{className:"mb-4",children:[e.jsx(w,{value:"form-settings",children:"Form Settings"}),e.jsx(w,{value:"form-fields",children:"Form Fields"})]}),e.jsx(T,{value:"form-settings",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"name",children:"Form Name"}),e.jsx(d,{as:c,id:"name",name:"name",placeholder:"Contact Form",onChange:s=>{a("name",s.target.value);const n=i.slug,o=t.name?t.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,""):"";if(!n||n===o){const x=s.target.value.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"");a("slug",x)}}}),e.jsx(N,{name:"name",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"slug",children:"Form Slug"}),e.jsx(d,{as:c,id:"slug",name:"slug",placeholder:"contact-form"}),e.jsx(N,{name:"slug",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"description",children:"Description"}),e.jsx(d,{as:u,id:"description",name:"description",placeholder:"Optional form description"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"submit_button_text",children:"Submit Button Text"}),e.jsx(d,{as:c,id:"submit_button_text",name:"submit_button_text",placeholder:"Submit"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"success_message",children:"Success Message"}),e.jsx(d,{as:u,id:"success_message",name:"success_message",placeholder:"Thank you for your submission!"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"notification_email",children:"Notification Email"}),e.jsx(d,{as:c,id:"notification_email",name:"notification_email",type:"email",placeholder:"admin@example.com"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"alternative_email",children:"Alternative Email"}),e.jsx(d,{as:c,id:"alternative_email",name:"alternative_email",type:"email",placeholder:"admin@example.com"})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"alternative_email",children:"Info Email"}),e.jsx(d,{as:c,id:"info_email",name:"info_email",type:"email",placeholder:"info@example.com"})]})]})}),e.jsx(T,{value:"form-fields",children:e.jsx(se,{name:"fields",children:s=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Form Fields"}),e.jsxs(m,{type:"button",onClick:()=>B(s),size:"sm",children:[e.jsx(ae,{className:"w-4 h-4 mr-2"}),"Add Field"]})]}),i.fields.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:'No fields added yet. Click "Add Field" to get started.'})}):e.jsx("div",{className:"space-y-2",children:i.fields.map((n,o)=>e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg bg-gray-50",children:[e.jsx(te,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:n.label}),e.jsxs("div",{className:"text-sm text-gray-500",children:[n.type," â€¢ ",n.required?"Required":"Optional",n.id&&e.jsxs("span",{className:"ml-2 text-xs bg-blue-100 text-blue-800 px-1 rounded",children:["ID: ",n.id]})]})]}),e.jsxs(H,{open:L&&O===o,onOpenChange:x=>{j(x),x||p(null)},children:[e.jsx(M,{asChild:!0,children:e.jsx(m,{type:"button",variant:"outline",size:"sm",onClick:()=>{p(o),j(!0)},children:e.jsx(ie,{className:"w-4 h-4"})})}),e.jsxs(Q,{className:"max-w-2xl",children:[e.jsx(J,{children:e.jsx(Y,{children:"Edit Field"})}),e.jsx(R,{field:n,index:o,setFieldValue:a})]})]}),e.jsx(m,{type:"button",variant:"outline",size:"sm",onClick:()=>P(s,o),children:e.jsx(re,{className:"w-4 h-4"})})]},n.id||o))}),e.jsx(N,{name:"fields",component:"div",className:"text-red-500 text-sm"})]})})})]})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(S,{children:[e.jsx(C,{children:e.jsxs($,{className:"flex items-center",children:[e.jsx(ne,{className:"w-4 h-4 mr-2"}),"Preview"]})}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-gray-50",children:[e.jsx("h3",{className:"font-medium",children:i.name||"Form Name"}),i.description&&e.jsx("p",{className:"text-sm text-gray-600",children:i.description}),i.fields.map((s,n)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs(r,{className:"text-sm",children:[s.label,s.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),s.type==="textarea"?e.jsx(u,{placeholder:s.placeholder,disabled:!0,className:"bg-white"}):s.type==="select"?e.jsx(v,{disabled:!0,children:e.jsx(f,{className:"bg-white",children:e.jsx(_,{placeholder:s.placeholder||"Select an option"})})}):e.jsx(c,{type:s.type,placeholder:s.placeholder,disabled:!0,className:"bg-white"}),s.help_text&&e.jsx("p",{className:"text-xs text-gray-500",children:s.help_text})]},s.id||n)),e.jsx(m,{disabled:!0,className:"w-full",children:i.submit_button_text})]})})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(m,{type:"button",variant:"outline",onClick:()=>b.get(route("form.index")),children:"Cancel"}),e.jsx(m,{type:"submit",disabled:l,children:l?"Updating...":"Update Form"})]})]})})]})})]})}export{ke as default};
