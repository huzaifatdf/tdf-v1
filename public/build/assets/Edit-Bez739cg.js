import{q as R,r as p,j as e,$ as A,m as P}from"./app-BNPjdzc-.js";import{A as _}from"./AuthenticatedLayout-euKnE-lQ.js";import{i as y,B as w,X as k,t as z}from"./toast-BiO_jOze.js";import{T as q}from"./textarea-hXe3btKR.js";import{S as B,a as J,b as Q,c as X,d as L}from"./select-CTvntk19.js";import{c as G,g as H,b as v,F as W,d as Y,e as S,E as N}from"./index.esm-BjpGDToP.js";import M from"./Model-CaxW3xSp.js";import{C as Z}from"./chevron-down-1SyvQQWV.js";import"./createLucideIcon-C7IeeHVu.js";import"./index-NHezvuo6.js";import"./index-DJgC9t1X.js";import"./alert-Q48zhNBh.js";import"./Modal-CdfNEWNC.js";import"./transition-CRjJp8pV.js";import"./search-mW_fi1Fl.js";import"./trash-2-CjfZuW0m.js";import"./video-1lXnN2Mh.js";import"./upload-D0dMLU5i.js";import"./download-CDJfpTZh.js";import"./eye-D4omaDvk.js";const V=({value:s,onChange:m,placeholder:f,fieldName:b})=>{const x=p.useRef(null),[u,g]=p.useState(!1);return p.useEffect(()=>{const l=async()=>{if(window.jQuery)j();else{const d=document.createElement("script");d.src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js",d.onload=()=>j(),document.head.appendChild(d)}},j=()=>{if(!document.querySelector('link[href*="summernote"]')){const d=document.createElement("link");d.rel="stylesheet",d.href="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-lite.min.css",document.head.appendChild(d)}if(window.$.fn.summernote)g(!0);else{const d=document.createElement("script");d.src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-lite.min.js",d.onload=()=>{g(!0)},document.head.appendChild(d)}};l()},[]),p.useEffect(()=>{if(u&&x.current&&window.$&&window.$.fn.summernote){const l=window.$(x.current);return l.summernote({placeholder:f||"Enter content...",tabsize:2,height:200,toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],callbacks:{onChange:function(j){m(j)},onInit:function(){s&&l.summernote("code",s)}}}),s&&l.summernote("code",s),()=>{l.summernote&&l.summernote("destroy")}}},[u,s,m,f]),p.useEffect(()=>{if(u&&x.current&&window.$&&window.$.fn.summernote){const l=window.$(x.current);l.summernote("code")!==s&&l.summernote("code",s||"")}},[s,u]),e.jsx("div",{className:"summernote-wrapper",children:e.jsx("textarea",{ref:x,className:"form-control",style:{display:"none"},defaultValue:s||""})})};function ge(){const{product:s,additionalDataStructure:m,appUrl:f}=R().props,[b,x]=p.useState(f+"/"+s.image||null),[u,g]=p.useState(f+"/"+s.thumbnail||null),[l,j]=p.useState({specifications:!0,pricing:!0,inventory:!1,seo:!1}),d=G({title:v().required("Title is required").min(2,"Title must be at least 2 characters").max(255,"Title must not exceed 255 characters"),slug:v().required("Slug is required").matches(/^[a-z0-9-]+$/,"Slug can only contain lowercase letters, numbers, and hyphens"),description:v().required("Description is required").min(10,"Description must be at least 10 characters"),status:v().required("Status is required").oneOf(["published","draft"],"Invalid status"),priority:H().required("Priority is required").min(0,"Priority must be at least 0").max(100,"Priority must not exceed 100")}),I=(r,{setSubmitting:i})=>{const a=new FormData;["title","slug","description","status","priority"].forEach(t=>{a.append(t,r[t])}),a.append("image",r.image),a.append("thumbnail",r.thumbnail);const n={};Object.keys(m).forEach(t=>{n[t]={},Object.keys(m[t]).forEach(h=>{const c=`${t}_${h}`;r[c]!==void 0&&r[c]!==""&&(n[t][h]=r[c])}),Object.keys(n[t]).length===0&&delete n[t]}),Object.keys(n).length>0&&a.append("additional_data",JSON.stringify(n)),a.append("_method","PUT"),P.post(route("product.update",s.id),a,{forceFormData:!0,onSuccess:()=>{i(!1)},onError:t=>{i(!1)}})},E=(r,i,a)=>{r(i,null),a(null)},O=r=>{j(i=>({...i,[r]:!i[r]}))},T=(r,i,a,o,n)=>{const t=`${r}_${i}`,h=o[t]||"";switch(a.type){case"summernote":return e.jsx(V,{value:h,onChange:c=>n(t,c),placeholder:`Enter ${a.label.toLowerCase()}`,fieldName:t});case"textarea":return e.jsx(q,{id:t,name:t,value:h,onChange:c=>n(t,c.target.value),placeholder:`Enter ${a.label.toLowerCase()}`,rows:3});case"number":return e.jsx(y,{id:t,name:t,type:"number",value:h,onChange:c=>n(t,c.target.value),placeholder:`Enter ${a.label.toLowerCase()}`,step:"0.01"});default:return e.jsx(y,{id:t,name:t,type:"text",value:h,onChange:c=>n(t,c.target.value),placeholder:`Enter ${a.label.toLowerCase()}`})}},D=()=>{const r={title:s.title||"",slug:s.slug||"",description:s.description||"",image:s.image||null,thumbnail:s.thumbnail||null,status:s.status||"",priority:s.priority||0},i=s.data?JSON.parse(s.data):{};return Object.keys(m).forEach(a=>{Object.keys(m[a]).forEach(o=>{var t;const n=`${a}_${o}`;r[n]=((t=i[a])==null?void 0:t[o])||""})}),r},[F,$]=p.useState(!1),[U,C]=p.useState(!1);return e.jsxs(_,{children:[e.jsx(A,{title:`Edit Product - ${s.title}`}),e.jsx("div",{className:"flex flex-1 flex-col",children:e.jsx("div",{className:"@container/main flex flex-1 flex-col gap-2 p-10",children:e.jsx("div",{className:"w-full",children:e.jsx(W,{initialValues:D(),validationSchema:d,onSubmit:I,children:({isSubmitting:r,setFieldValue:i,values:a})=>e.jsxs(Y,{className:"space-y-6 bg-white p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Edit Product"}),e.jsx("p",{className:"text-gray-600",children:"Update product information"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"title",className:"text-sm font-medium",children:"Product Title *"}),e.jsx(S,{as:y,id:"title",name:"title",placeholder:"Enter product title"}),e.jsx(N,{name:"title",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"slug",className:"text-sm font-medium",children:"Product Slug *"}),e.jsx(S,{as:y,id:"slug",name:"slug",placeholder:"Enter product slug"}),e.jsx(N,{name:"slug",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"description",className:"text-sm font-medium",children:"Description *"}),e.jsx(S,{as:q,id:"description",name:"description",placeholder:"Enter product description",rows:4}),e.jsx(N,{name:"description",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"status",className:"text-sm font-medium",children:"Status *"}),e.jsxs(B,{name:"status",value:a.status,onValueChange:o=>i("status",o),children:[e.jsx(J,{children:e.jsx(Q,{placeholder:"Select status"})}),e.jsxs(X,{children:[e.jsx(L,{value:"published",children:"Published"}),e.jsx(L,{value:"draft",children:"Draft"})]})]}),e.jsx(N,{name:"status",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"priority",className:"text-sm font-medium",children:"Priority (0-100) *"}),e.jsx(S,{as:y,id:"priority",name:"priority",type:"number",min:"0",max:"100",placeholder:"0"}),e.jsx(N,{name:"priority",component:"div",className:"text-red-500 text-sm"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"image",className:"text-sm font-medium",children:"Product Image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:[e.jsx("button",{type:"button",onClick:()=>$(!0),children:b?"Change Media":"Add Media"}),e.jsx(M,{routename:route("product.edit",s.id),showModal:F,setShowModal:$,setFieldValue:i,fieldName:"image",setImagePreview:x}),b&&e.jsxs("div",{className:"relative mt-4",children:[e.jsx("img",{src:typeof b=="string"?b:URL.createObjectURL(b),alt:"Product Preview",className:"w-24 h-24 object-cover rounded-lg mx-auto"}),e.jsx(w,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2",onClick:()=>E(i,"image",x),children:e.jsx(k,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{htmlFor:"thumbnail",className:"text-sm font-medium",children:"Thumbnail Image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:[e.jsx("button",{type:"button",onClick:()=>C(!0),children:u?"Change Media":"Add Media"}),e.jsx(M,{routename:route("product.edit",s.id),showModal:U,setShowModal:C,setFieldValue:i,fieldName:"thumbnail",setImagePreview:g}),u&&e.jsxs("div",{className:"relative mt-4",children:[e.jsx("img",{src:typeof u=="string"?u:URL.createObjectURL(u),alt:"Thumbnail Preview",className:"w-24 h-24 object-cover rounded-lg mx-auto"}),e.jsx(w,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2",onClick:()=>E(i,"thumbnail",g),children:e.jsx(k,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:"Additional Information"}),Object.keys(m).map(o=>e.jsxs("div",{className:"border rounded-lg",children:[e.jsxs("button",{type:"button",className:"w-full px-4 py-3 text-left flex items-center justify-between bg-gray-50 hover:bg-gray-100 rounded-t-lg",onClick:()=>O(o),children:[e.jsx("span",{className:"font-medium capitalize",children:o.replace("_"," ")}),l[o]?e.jsx(Z,{className:"h-4 w-4"}):e.jsx(z,{className:"h-4 w-4"})]}),l[o]&&e.jsx("div",{className:"p-4 space-y-4 border-t",children:Object.keys(m[o]).map(n=>{const t=m[o][n],h=`${o}_${n}`;return e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("label",{htmlFor:h,className:"text-sm font-medium",children:[t.label,t.required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),T(o,n,t,a,i)]},n)})})]},o))]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(w,{type:"button",variant:"outline",onClick:()=>P.get(route("product.index")),children:"Cancel"}),e.jsx(w,{type:"submit",disabled:r,children:r?"Updating...":"Update Product"})]})]})})})})})]})}export{ge as default};
